<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="SpreadWings-Sky"><meta name="copyright" content="SpreadWings-Sky"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>ASP.NET web | 俺たちに翼はない</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.24/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link class="aplayer-style-marker" rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.css"><script class="aplayer-script-marker" src="https://cdn.jsdelivr.net/npm/aplayer@latest/dist/APlayer.min.js" defer></script><script class="meting-script-marker" src="https://cdn.jsdelivr.net/npm/meting@1/dist/Meting.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js" defer></script><script src="/js/pjax.js" defer></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><link rel="shortcut icon" type="image/svg+xml" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"spreadwings-sky.github.io","root":"/","title":"俺たちに翼はない","version":"1.5.1","mode":"auto","copycode":true,"page":{"isPost":true},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><meta name="description" content="ASP.NET web 程序设计第1章 ASP.NET Web应用程序基础1.1 Web应用程序简介 Web 应用程序概述  随着互联网技术的不断发展，各式网络程序开发体系结构应运而生，运用最多的网络应用程序开发体系结构可以分为两种： (1)基于客户端和服务器端的 C&#x2F;S 结构 ​    C&#x2F;S 体系结构：Client&#x2F;Server 的缩写，即客户端 &#x2F; 服务器端结构 (2)基于浏览器和服务器的">
<meta property="og:type" content="article">
<meta property="og:title" content="ASP.NET web">
<meta property="og:url" content="https://spreadwings-sky.github.io/2020/12/28/ASP.NET%20web%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/index.html">
<meta property="og:site_name" content="俺たちに翼はない">
<meta property="og:description" content="ASP.NET web 程序设计第1章 ASP.NET Web应用程序基础1.1 Web应用程序简介 Web 应用程序概述  随着互联网技术的不断发展，各式网络程序开发体系结构应运而生，运用最多的网络应用程序开发体系结构可以分为两种： (1)基于客户端和服务器端的 C&#x2F;S 结构 ​    C&#x2F;S 体系结构：Client&#x2F;Server 的缩写，即客户端 &#x2F; 服务器端结构 (2)基于浏览器和服务器的">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-12-28T11:03:47.000Z">
<meta property="article:modified_time" content="2021-03-28T13:11:09.253Z">
<meta property="article:author" content="SpreadWings-Sky">
<meta property="article:tag" content="笔记">
<meta name="twitter:card" content="summary"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="SpreadWings-Sky"><img width="96" loading="lazy" src="/images/avatar.png" alt="SpreadWings-Sky"><span class="site-author-status" title="颓废">😀</span></a><div class="site-author-name"><a href="/about/">SpreadWings-Sky</a></div><a class="site-name" href="/about/site.html">俺たちに翼はない</a><sub class="site-subtitle"></sub><div class="site-desciption">浊以静之徐清，安以动之徐生</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">10</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">3</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">6</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://qm.qq.com/cgi-bin/qm/qr?k=HsOz2F7Lo4jqB1Xo4lXokuVbuIC4P1ND" title="QQ" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/SpreadWings-Sky" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=267190570" title="网易云音乐" target="_blank" style="color:#C10D0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/23237818" title="哔哩哔哩动画" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://t.me/SpreadWingSky" title="Telegram" target="_blank" style="color:#0088CC"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-telegram-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ASP-NET-web-%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.</span> <span class="toc-text">ASP.NET web 程序设计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC1%E7%AB%A0-ASP-NET-Web%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%9F%BA%E7%A1%80"><span class="toc-number">1.1.</span> <span class="toc-text">第1章 ASP.NET Web应用程序基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-Web%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 Web应用程序简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-HTTP-%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 HTTP 协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-ASP-NET%E7%AE%80%E4%BB%8B%E5%8F%8A-Web-Forms%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 ASP.NET简介及 Web Forms的创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-Web-Forms-%E5%9F%BA%E6%9C%AC%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.4 Web Forms 基本控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.1.5.</span> <span class="toc-text">验证控件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81%E6%96%B9%E5%BC%8F"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">数据验证方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E6%8E%A7%E4%BB%B6%E7%B1%BB%E5%9E%8B-%E5%9C%A8Visual-Studio-2019-%E4%B8%AD%EF%BC%8C%E9%AA%8C%E8%AF%81%E6%8E%A7%E4%BB%B6%E5%8F%AF%E4%BB%A5%E5%9C%A8%E2%80%9C%E5%B7%A5%E5%85%B7%E7%AE%B1%E2%80%9D%E7%9A%84%E2%80%9C%E9%AA%8C%E8%AF%81%E2%80%9D%E6%A0%8F%E4%B8%AD%E6%89%BE%E5%88%B0%E3%80%82"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">验证控件类型(在Visual Studio 2019 中，验证控件可以在“工具箱”的“验证”栏中找到。)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E8%A6%81%E6%B1%82%E7%94%A8%E6%88%B7%E5%9C%A8%E9%A1%B5%E9%9D%A2%E4%B8%8A%E5%BF%85%E9%A1%BB%E8%BE%93%E5%85%A5%E5%BF%85%E5%A1%AB%E5%86%85%E5%AE%B9%EF%BC%8C%E5%B8%B8%E7%94%A8%E4%BA%8E%E6%96%87%E6%9C%AC%E6%A1%86%E2%80%9C%E4%B8%8D%E8%83%BD%E4%B8%BA%E7%A9%BA%E2%80%9D%E7%9A%84%E9%AA%8C%E8%AF%81"><span class="toc-number">1.1.5.2.1.</span> <span class="toc-text">1-要求用户在页面上必须输入必填内容，常用于文本框“不能为空”的验证</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%92%EF%BC%8D%E7%94%A8%E4%BA%8E%E6%89%A7%E8%A1%8C%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%9F%A5%EF%BC%8C%E6%88%96%E6%AF%94%E8%BE%83%E4%B8%80%E4%B8%AA%E5%80%BC%E5%92%8C%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%80%BC%EF%BC%8C%E4%BB%A5%E7%A1%AE%E5%AE%9A%E4%B8%A4%E4%B8%AA%E5%80%BC%E6%98%AF%E5%90%A6%E4%B8%8E%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6%E6%8C%87%E5%AE%9A%E7%9A%84%E5%85%B3%E7%B3%BB%E5%8C%B9%E9%85%8D"><span class="toc-number">1.1.5.2.2.</span> <span class="toc-text">２－用于执行数据类型检查，或比较一个值和另一个值，以确定两个值是否与比较运算符指定的关系匹配</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%93%EF%BC%8D%E7%94%A8%E4%BA%8E%E6%A3%80%E6%9F%A5%E8%BE%93%E5%85%A5%E7%9A%84%E5%80%BC%E6%98%AF%E5%90%A6%E5%9C%A8%E7%A1%AE%E8%AE%A4%E7%9A%84%E6%9C%80%E5%B0%8F%E5%80%BC%E5%92%8C%E6%9C%80%E5%A4%A7%E5%80%BC%E4%B9%8B%E9%97%B4"><span class="toc-number">1.1.5.2.3.</span> <span class="toc-text">３－用于检查输入的值是否在确认的最小值和最大值之间</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E7%94%A8%E4%BA%8E%E6%A3%80%E6%9F%A5%E7%94%A8%E6%88%B7%E7%9A%84%E8%BE%93%E5%85%A5%E6%98%AF%E5%90%A6%E4%B8%8E%E9%A2%84%E5%AE%9A%E4%B9%89%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9B%B8%E5%8C%B9%E9%85%8D"><span class="toc-number">1.1.5.2.4.</span> <span class="toc-text">4-用于检查用户的输入是否与预定义的正则表达式相匹配</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.1.6.</span> <span class="toc-text">高级控件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AF%8D%E7%89%88%E9%A1%B5%E5%92%8C%E5%86%85%E5%AE%B9%E9%A1%B5"><span class="toc-number">1.1.6.1.</span> <span class="toc-text">母版页和内容页</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-number">1.1.6.1.1.</span> <span class="toc-text">优点</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#FileUpload-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.1.6.2.</span> <span class="toc-text">FileUpload 文件上传控件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">1.1.6.3.</span> <span class="toc-text">文件下载</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TreeView-%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.1.6.4.</span> <span class="toc-text">TreeView 控件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AB%99%E7%82%B9%E5%9C%B0%E5%9B%BE"><span class="toc-number">1.1.6.4.1.</span> <span class="toc-text">站点地图</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E6%94%AF%E6%8C%81%E5%8A%9F%E8%83%BD%EF%BC%9A"><span class="toc-number">1.1.6.4.1.1.</span> <span class="toc-text">主要支持功能：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.1.7.</span> <span class="toc-text">系统对象</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Page-%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.1.7.1.</span> <span class="toc-text">Page 对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Response-%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.1.7.2.</span> <span class="toc-text">Response 对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Request-%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.1.7.3.</span> <span class="toc-text">Request 对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.1.7.4.</span> <span class="toc-text">Server 对象</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC5%E7%AB%A0-%E9%A1%B5%E9%9D%A2%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86"><span class="toc-number">1.2.</span> <span class="toc-text">第5章 页面状态管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-Cookie-%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.2.1.</span> <span class="toc-text">5.1 Cookie 对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-Session-%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.2.2.</span> <span class="toc-text">5.2 Session 对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-Application-%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.2.3.</span> <span class="toc-text">5.3 Application 对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-Session-%E8%B4%AD%E7%89%A9%E8%BD%A6%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B"><span class="toc-number">1.2.4.</span> <span class="toc-text">5.4 Session 购物车综合案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC6%E7%AB%A0-%E4%B8%89%E5%B1%82%E6%9E%B6%E6%9E%84"><span class="toc-number">1.3.</span> <span class="toc-text">第6章 三层架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E4%B8%89%E5%B1%82%E6%9E%B6%E6%9E%84%E7%90%86%E8%A7%A3"><span class="toc-number">1.3.1.</span> <span class="toc-text">6.1 三层架构理解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E6%A8%A1%E5%9E%8B%E5%B1%82%E4%B8%8E%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE%E5%B1%82%E7%9A%84%E6%90%AD%E5%BB%BA"><span class="toc-number">1.3.2.</span> <span class="toc-text">6.2 模型层与数据访问层的搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E4%B8%9A%E5%8A%A1%E5%B1%82%E7%9A%84%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%B1%82%E4%B9%8B%E9%97%B4%E7%9A%84%E8%B0%83%E7%94%A8"><span class="toc-number">1.3.3.</span> <span class="toc-text">6.3 业务层的搭建以及与数据层之间的调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E8%A1%A8%E7%8E%B0%E5%B1%82%E4%BB%A5%E5%8F%8A%E4%B8%89%E5%B1%82%E8%B0%83%E7%94%A8"><span class="toc-number">1.3.4.</span> <span class="toc-text">6.4 表现层以及三层调用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC7%E7%AB%A0-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E6%8E%A7%E4%BB%B6%EF%BC%88%E4%B8%80%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">第7章 数据绑定控件（一）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.4.1.</span> <span class="toc-text">7.1 数据绑定控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-DropDownList-%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.4.2.</span> <span class="toc-text">7.2 DropDownList 控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-DataList-%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.4.3.</span> <span class="toc-text">7.3 DataList 控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-Repeater-%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.4.4.</span> <span class="toc-text">7.4 Repeater 控件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC8%E7%AB%A0-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E6%8E%A7%E4%BB%B6%EF%BC%88%E4%BA%8C%EF%BC%89"><span class="toc-number">1.5.</span> <span class="toc-text">第8章 数据绑定控件（二）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-GridView-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A"><span class="toc-number">1.5.1.</span> <span class="toc-text">8.1 GridView 数据绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-GridView-%E6%95%B0%E6%8D%AE%E5%88%A0%E9%99%A4"><span class="toc-number">1.5.2.</span> <span class="toc-text">8.2 GridView 数据删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-GridView-%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9"><span class="toc-number">1.5.3.</span> <span class="toc-text">8.3 GridView 数据修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-GridView-%E6%95%B0%E6%8D%AE%E5%88%86%E9%A1%B5"><span class="toc-number">1.5.4.</span> <span class="toc-text">8.4 GridView 数据分页</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://SpreadWings-Sky.github.io/2020/12/28/ASP.NET%20web%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="SpreadWings-Sky"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="俺たちに翼はない"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">ASP.NET web</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2020-12-28 19:03:47" itemprop="dateCreated datePublished" datetime="2020-12-28T19:03:47+08:00">2020-12-28</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="修改时间：2021-03-28 21:11:09" itemprop="dateModified" datetime="2021-03-28T21:11:09+08:00">2021-03-28</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="本文字数">19k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="阅读时长">87m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">学习笔记</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/%E7%AC%94%E8%AE%B0/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">笔记</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h1 id="ASP-NET-web-程序设计"><a href="#ASP-NET-web-程序设计" class="headerlink" title="ASP.NET web 程序设计"></a>ASP.NET web 程序设计</h1><h2 id="第1章-ASP-NET-Web应用程序基础"><a href="#第1章-ASP-NET-Web应用程序基础" class="headerlink" title="第1章 ASP.NET Web应用程序基础"></a>第1章 ASP.NET Web应用程序基础</h2><h3 id="1-1-Web应用程序简介"><a href="#1-1-Web应用程序简介" class="headerlink" title="1.1 Web应用程序简介"></a>1.1 Web应用程序简介</h3><ol>
<li>Web 应用程序概述</li>
</ol>
<p>随着互联网技术的不断发展，各式网络程序开发体系结构应运而生，运用最多的网络应用程序开发体系结构可以分为两种： (1)基于客户端和服务器端的 C/S 结构</p>
<p>​    C/S 体系结构：Client/Server 的缩写，即客户端 / 服务器端结构</p>
<p>(2)基于浏览器和服务器的 B/S 结构</p>
<p>​    B/S 体系结构：Browser/Server 的缩写，即浏览器 / 服务器结构</p>
<p>2.Web 应用程序的工作原理</p>
<p>（1）Web 应用程序大致可以分为两种，即静态网站和动态网站。<strong>早期的 Web 应用主要是静态页面的浏览，即静态网站。</strong> （2）随着互联网技术的发展，更多的<strong>内容需根据用户的请求动态生成页面信息，即动态网站。</strong></p>
<h3 id="1-2-HTTP-协议"><a href="#1-2-HTTP-协议" class="headerlink" title="1.2 HTTP 协议"></a>1.2 HTTP 协议</h3><ol>
<li><p>URL 简介</p>
<p>URL 是 Uniform ResourceLocator 的缩写，表示统一资源定位器，它是专为标识网络上的资源位置而设定的一种编码地址方式 URL 通常由 4 个部分组成，包括应用层协议、主机 IP 地址或域名、协议端口号以及资源所在的路径和文件名</p>
<p>语法为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">应用层协议 :&#x2F;&#x2F; 主机 IP 地址或域名 &#x2F; 资源所在路径 &#x2F; 文件名</span><br></pre></td></tr></table></figure>

</li>
<li><p>HTTP 协议概述</p>
<p>（1）HTTP 协议（HyperText Transfer Protocol，超级文本传输协议）是关于如何在网络上传输超级文本及 HTML 文档的协议 （2）Web 浏览器通过 URL 与 Web 服务器建立网络连接后，按照 HTTP 协议的规定向 Web 服务器发送请求信息，Web 服务器接收到浏览器的请求后，再按照 HTTP 协议的要求将结果发送给 Web 浏览器</p>
</li>
<li><p>HTTP 协议处理流程</p>
<p>（1）浏览器发出一个 HTTP 请求，服务器能够返回一个响应，并且通过一个 HTTP 请求只能对应一个响应，每个过程都是独立的。 （2）一次完整的请求响应过程分为以下 4 个步骤：     1）客户端和 Web 服务器建立连接     2）客户端发送 HTTP 请求     3）服务器端接受客户端的请求，生成 HTTP 响应并发送给客户端     4）服务器端关闭连接。客户端接收服务器端的响应，恢复页面</p>
<p>注意：服务器端关闭连接后，不再存储连接信息，所以 <strong>HTTP 协议被称为无状态协议</strong>。</p>
</li>
<li><p>HTTP 请求方式</p>
</li>
</ol>
<p>（1）HTTP 请求可以使用多种请求方式，常用方式包括以下两种： GET 请求方式：GET 为表单的默认提交方式 POST 请求方式：客户程序可通过此方式发送大量信息给服务器 （2）GET 和 POST 的请求方式的区别主要分为以下几点：     GET请求方式仅能传送文本给服务器；POST请求方式可以传送二进制数据如音频、视频等      GET请求方式提交的数据会暴露在地址栏，不安全；POST请求方式提交的数据则不会暴露在地址栏，安全性高。     GET请求方式提交的数据不能超过 2KB，POST请求方式则无此限制。     表单通过method属性来指定使用哪种请求方式，默认为GET请求方式。</p>
<h3 id="1-3-ASP-NET简介及-Web-Forms的创建"><a href="#1-3-ASP-NET简介及-Web-Forms的创建" class="headerlink" title="1.3 ASP.NET简介及 Web Forms的创建"></a>1.3 ASP.NET简介及 Web Forms的创建</h3><ol>
<li><p>ASP.NET 简介</p>
<p>ASP.NET 是微软 .NET 体系提供的 Web 开发框架，它可以使开发人员用尽可能少的代码生成企业级 Web 应用程序所需要的各种服务。 ASP.NET <strong>支持 3 种开发模式</strong>： （1）Web  Pages</p>
<p>Web Page， 适合于初级学习者，在一些小型及大型项目中广泛应用，也适合熟悉网络编程爱好者</p>
<p>（2）Web  Forms</p>
<p>Web Form，适合于初级学习者，适合于各种规模的项目。最适合有Windows Form开发转移过来的Asp.Net新手。本人就是</p>
<p>这一范畴内。目前也是.Net平台下最成熟的框架。企业端程序多半采用WebForm。缺点也比较明显，新型的技术开发较少在</p>
<p>其上面发布，逐渐转移到MVC框架下（WEB API, REST等等）</p>
<p>（3）MVC</p>
<p>ASP.NET MVC 是最新的开发平台，适合各种大小项目，目前是主要潮流和趋势。为全新项目的开发提供一个新的设计思想选择。</p>
<p>可以灵活的模块化代码，但是其学习时间需要更长。目前与WebForm一起作为微软的主流框架，被广泛推广。</p>
</li>
<li><p>创建Web Forms应用程序</p>
</li>
</ol>
<p>（1）使用Visual Studio 2017 创建ASP.NET站点应用程序，步骤如下： （2）启动 Visual Studio 2017 后，在主界面选择“新建（N）” “项目（P）…” （3）选择项目模板及类型 （4）点击“确定”按钮，进入应用程序选择窗体，选择 Web 窗体应用程序 （5）使用快捷键“Ctrl+F5”编译并执行站点程序 （6）运行结果</p>
<p>3.站点结构分析: （1）.aspx 是 Web Forms 窗体页面的后缀 （2）App_Data文件夹是 ASP.NET提供程序存储自身数据的默认位置 （3）App_Start 文件夹是应用程序静态配置文件。 （4）Content 文件夹用于存放样式表等资源文件。 （5）fonts 文件夹用于存放项目中需要使用到的字体。 （6）Scripts 文件夹用于存放站点所用到的 JavaScript 脚本文件</p>
<p>注意：<strong>Default.aspx 是项目默认首页，也可以使用 Index.aspx 代替</strong></p>
<ol>
<li>页面文件结构分析: 页面文件由两部分组成：一部分是以“文件名 .aspx”方式命名的页面源文件，另一部分是以“文件名 .aspx.cs”方式命名的页面类文件 Default.aspx代码</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*page指令  Language 编程语言   AutoEventWireup 是否启用页面自动事件回传 CodeFile 页面对应类文件 Inherits 页面对应类的类名*&#x2F; </span><br><span class="line">&lt;%@Page Title&#x3D;&quot;Home Page&quot; Language&#x3D;&quot;C#&quot; MasterPageFile&#x3D;&quot;~&#x2F;Site.Master&quot;</span><br><span class="line">AutoEventWireup&#x3D;&quot;true&quot; CodeFile&#x3D;&quot;Default.aspx.cs&quot; Inherits&#x3D;&quot;_Default&quot; %&gt;</span><br><span class="line">&lt;asp:Content runat&#x3D;&quot;server&quot; ID&#x3D;&quot;FeaturedContent&quot; ContentPlaceHolderID&#x3D;&quot;FeaturedContent&quot;&gt;</span><br><span class="line">  ……</span><br><span class="line">&lt;&#x2F;asp:Content&gt;</span><br><span class="line">&lt;asp:Content runat&#x3D;&quot;server&quot; ID&#x3D;&quot;BodyContent&quot; ContentPlaceHolderID&#x3D;&quot;MainContent&quot;&gt;</span><br><span class="line">  ……</span><br><span class="line">&lt;&#x2F;asp:Content&gt;</span><br></pre></td></tr></table></figure>

<ol>
<li>页面文件结构分析: Default.aspx.cs代码</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;继承Page类</span><br><span class="line">public  partial  class  _Default : Page</span><br><span class="line">&#123;</span><br><span class="line">  protected  void  Page_Load(object  sender,EventArgs  e)</span><br><span class="line">      &#123;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  Page 类提供 .aspx文件的基本行为，Page的父类TemplateControl类定义了页面（或控件）的基本功能  TemplateControl类的父类Control类定义了 ASP.NET 服务器端元素（包括页面、控件）共享的属性、方法和事件</p>
<ol>
<li>在浏览器中运行 ASP.NET 页面: Visual Studio2017通过启动 IIS Express（简易版的 Internet 信息服务器）来运行站点程序，在浏览器中即可看到 Default.aspx 页面的执行结果。</li>
</ol>
<h3 id="1-4-Web-Forms-基本控件"><a href="#1-4-Web-Forms-基本控件" class="headerlink" title="1.4 Web Forms 基本控件"></a>1.4 Web Forms 基本控件</h3><p>ASP.NET 沿用Windows Forms编程中的事件驱动概念，使用类似于Windows Forms中的控件，其属性和事件也与Windows  Forms中控件的属性方法类似 使用 Label、TextBox 和 Button 3 种控件实现页面数据的输入和显示功能，步骤如下： （1）在 Visual Studio 2017 中创建一个空的 Web 应用程序。 （2）在该程序中新建一个 Web 窗体页面，并且取名为 Login。 （3）切换回“设计”视图，并展开工具箱</p>
<p>（4）从 工 具 箱 中 分 别 拖 放 Label、TextBox 和 Button 控 件 到 Login.aspx 页 面 的“form”内，并按控件命名规则，将这 3 个控件分别命名为”lblMessage” “txtUserName”和”btnSure“ （5）双击 Login.aspx 页面上的”确定”按钮，首先为按钮注册 Click（点击）事件，同时打开 Login.aspx对应的类文件 Login.aspx.cs，并在该类文件中自动创建按钮 Click 事件的处理方法 （6）在 btnSure_Click 方法中编写如下代码 （7）用鼠标右键点击 Default.aspx，选择“在浏览器中查看”</p>
<h3 id="验证控件"><a href="#验证控件" class="headerlink" title="验证控件"></a>验证控件</h3><h4 id="数据验证方式"><a href="#数据验证方式" class="headerlink" title="数据验证方式"></a>数据验证方式</h4><ul>
<li>后端代码验证，是将数据提交给服务器来验证</li>
<li>JavaScript 验证，整个验证过程无需服务器参与，提高验证响应速度</li>
<li>服务器验证控件，通过控件实现客户端加服务端的双重验证，为数据验证提供安全方便的解决方案</li>
</ul>
<h4 id="验证控件类型-在Visual-Studio-2019-中，验证控件可以在“工具箱”的“验证”栏中找到。"><a href="#验证控件类型-在Visual-Studio-2019-中，验证控件可以在“工具箱”的“验证”栏中找到。" class="headerlink" title="验证控件类型(在Visual Studio 2019 中，验证控件可以在“工具箱”的“验证”栏中找到。)"></a>验证控件类型(在Visual Studio 2019 中，验证控件可以在“工具箱”的“验证”栏中找到。)</h4><ol>
<li>RequiredFieldValidator(非空)</li>
<li>CompareValidator(比较)</li>
<li>RangeValidator(范围)</li>
<li>RegularExceptionValidator(正则表达式)</li>
<li>CustomValidator（自定义）</li>
<li>ValidationSummary(验证汇总)</li>
</ol>
<h5 id="1-要求用户在页面上必须输入必填内容，常用于文本框“不能为空”的验证"><a href="#1-要求用户在页面上必须输入必填内容，常用于文本框“不能为空”的验证" class="headerlink" title="1-要求用户在页面上必须输入必填内容，常用于文本框“不能为空”的验证"></a>1-要求用户在页面上必须输入必填内容，常用于文本框“不能为空”的验证</h5><table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>ＣｏｎｔｒｏｌＴｏＶａｌｉｄａｔｅ</td>
<td>要验证控件的ＩＤ，所以验证控件都有该属性</td>
</tr>
<tr>
<td>Ｔｅｘｔ</td>
<td>验证出错时的提示，所以验证控件都有该属性</td>
</tr>
<tr>
<td>ＥｒｒｏＭｅｓｓａｇｅ</td>
<td>提交给汇总控件的信息，如果Ｔｅｘｔ属性为空，则显示改信息</td>
</tr>
</tbody></table>
<h5 id="２－用于执行数据类型检查，或比较一个值和另一个值，以确定两个值是否与比较运算符指定的关系匹配"><a href="#２－用于执行数据类型检查，或比较一个值和另一个值，以确定两个值是否与比较运算符指定的关系匹配" class="headerlink" title="２－用于执行数据类型检查，或比较一个值和另一个值，以确定两个值是否与比较运算符指定的关系匹配"></a>２－用于执行数据类型检查，或比较一个值和另一个值，以确定两个值是否与比较运算符指定的关系匹配</h5><table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>ＣｏｎｔｒｏｌＴｏＶａｌｉｄａｔｅ</td>
<td>要验证的控件ＩＤ</td>
</tr>
<tr>
<td>ＣｏｎｔｒｏｌＴｏＣｏｍｐａｒｅ</td>
<td>用于比较的控件ＩＤ</td>
</tr>
<tr>
<td>Ｔｙｐｅ</td>
<td>设置比较类型，不同类型比较会出错</td>
</tr>
<tr>
<td>Ｏｐｅｒａｔｏｒ</td>
<td>设置比较运算符</td>
</tr>
<tr>
<td>ＶａｌｕｅＴｏＣｏｍｐａｒｅ</td>
<td>用于比较的值</td>
</tr>
</tbody></table>
<h5 id="３－用于检查输入的值是否在确认的最小值和最大值之间"><a href="#３－用于检查输入的值是否在确认的最小值和最大值之间" class="headerlink" title="３－用于检查输入的值是否在确认的最小值和最大值之间"></a>３－用于检查输入的值是否在确认的最小值和最大值之间</h5><table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>ＣｏｎｔｒｏｌＴｏＶａｌｉｄａｔｅ</td>
<td>要验证的控件ＩＤ</td>
</tr>
<tr>
<td>MaximumValue</td>
<td>最大值</td>
</tr>
<tr>
<td>minimumValue</td>
<td>最小值</td>
</tr>
<tr>
<td>Type</td>
<td>验证类型</td>
</tr>
</tbody></table>
<h5 id="4-用于检查用户的输入是否与预定义的正则表达式相匹配"><a href="#4-用于检查用户的输入是否与预定义的正则表达式相匹配" class="headerlink" title="4-用于检查用户的输入是否与预定义的正则表达式相匹配"></a>4-用于检查用户的输入是否与预定义的正则表达式相匹配</h5><p>ValidationExpre 用于设置验证的正则表达式</p>
<h3 id="高级控件"><a href="#高级控件" class="headerlink" title="高级控件"></a>高级控件</h3><h4 id="母版页和内容页"><a href="#母版页和内容页" class="headerlink" title="母版页和内容页"></a>母版页和内容页</h4><p>母版页以.master 为后缀，不能独立运行，母版页至少包含一个内容占位器[ContentPlaceHolder]</p>
<p>它可以实现页面统一布局，并将页面上的公用元素（如网站 Logo、广告条和导航条等）整合到一起。内容页（Default.aspx）对应的是母版页（Site.master），母版页和内容页的关系如图。</p>
<p>格式为：页头+页脚为母版，内容为子版页的结合。</p>
<h5 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h5><ul>
<li>有利于站点修改和维护，降低工作强度</li>
<li>具备高效的内容整和能力</li>
<li>有利于实现页面布局</li>
<li>提供便于使用的对象模型</li>
</ul>
<p>内容页创建为【包含母版页的 web 窗体】选择相应的母版页</p>
<p>内容页的内容只能写在对应的[ContentPlaceHolder]中，其他部分不能出现任何内容</p>
<p><strong>母版页的使用</strong></p>
<p>（1）创建新母版页的方法是在 Visual Studio 2019 的“资源管理器”中点击鼠标右键，选择“添加” “添加新项”“Web 窗体母版页”。</p>
<p>（2）新创建的母版页上包含两个 ContentPlaceHolder 控件。ID 为“head”的控件是预留给加载页面样式和 JavaScript 文件的，ID 为ContentPlaceHolder1”的控件是预留给内容页显示的。</p>
<p>（3）在新创建的母版页中添加页头、页脚和代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Master Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;Main.master.cs&quot; Inherits&#x3D;&quot;web3.Main&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&#x2F;&gt;</span><br><span class="line">    &lt;title&gt;资源网&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;asp:ContentPlaceHolder ID&#x3D;&quot;head&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">    &lt;&#x2F;asp:ContentPlaceHolder&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        这里是页头</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;asp:ContentPlaceHolder ID&#x3D;&quot;ContentPlaceHolder1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">            &lt;&#x2F;asp:ContentPlaceHolder&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        这里是页脚</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>4、内容页</p>
<p>母版页是页面的框架，需要通过内容页来填充页面内容。每一个内容页对应母版页中的一个位置（ContentPlaceHolder控件所占的位置）。 在 Visual Studio 2019中，新建页面时，可以选择已创建的母版页。在 Visual Studio 2019 的“资源管理器”中，点击鼠标右键，选择“添加” “添加新项” “包含母版页的 Web 窗体” 。</p>
<p>选择“MasterPage.master”母版页，点击“确定”按钮，创建 Index.aspx 内容页。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Title&#x3D;&quot;首页&quot; Language&#x3D;&quot;C#&quot; MasterPageFile&#x3D;&quot;~&#x2F;Main.Master&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;index.aspx.cs&quot; Inherits&#x3D;&quot;web3.index&quot; %&gt;</span><br><span class="line">&lt;asp:Content ID&#x3D;&quot;Content1&quot; ContentPlaceHolderID&#x3D;&quot;head&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;&#x2F;asp:Content&gt;</span><br><span class="line">&lt;asp:Content ID&#x3D;&quot;Content2&quot; ContentPlaceHolderID&#x3D;&quot;ContentPlaceHolder1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">    这里是中间内容区</span><br><span class="line">&lt;&#x2F;asp:Content&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> <strong>母版页和普通页面有如下区别</strong> 1、 声明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">普通页的声明是：</span><br><span class="line">&lt;%@ Page Title&#x3D;&quot;Home Page&quot; Language&#x3D;&quot;C#&quot; MasterPageFile&#x3D;&quot;…&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeFile&#x3D;&quot;…&quot; Inherits&#x3D;&quot;…&quot; %&gt;</span><br><span class="line">母版页的声明是：</span><br><span class="line">&lt;%@ Master Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeFile&#x3D;&quot;…&quot; Inherits&#x3D;&quot;…&quot; %&gt;</span><br></pre></td></tr></table></figure>

<p>2 扩展名 普通页的后缀名是 .aspx，母版页的后缀名是 .master。</p>
<p>3 ContentPlaceHolder 控件。 母版页可以使用一个或多个 ContentPlaceHolder 控件，普通页不使用该控件。</p>
<h4 id="FileUpload-文件上传控件"><a href="#FileUpload-文件上传控件" class="headerlink" title="FileUpload 文件上传控件"></a>FileUpload 文件上传控件</h4><table>
<thead>
<tr>
<th>属性</th>
<th>内容</th>
</tr>
</thead>
<tbody><tr>
<td>HasFile</td>
<td>控件是否含有将要上传的文件</td>
</tr>
<tr>
<td>FileName</td>
<td>上传文件的文件名</td>
</tr>
<tr>
<td>SaveAs(函数)</td>
<td>将上传文件保存到服务器指定的路径</td>
</tr>
</tbody></table>
<p>在设计页添加【FileUpload】控件后添加对应事件</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (FileUpload.HasFile)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//获取上传文件名</span></span><br><span class="line">                <span class="built_in">string</span> fileName = FileUpload.FileName;</span><br><span class="line">                <span class="comment">//获取上传文件后缀名</span></span><br><span class="line">                <span class="built_in">string</span> fileFix = Path.GetExtension(fileName).ToLower();</span><br><span class="line">                <span class="keyword">if</span> (fileFix == <span class="string">&quot;.png&quot;</span> || fileFix == <span class="string">&quot;.jpg&quot;</span> || fileFix == <span class="string">&quot;.jpeg&quot;</span> || fileFix == <span class="string">&quot;.pic&quot;</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    FileUpload.SaveAs(Server.MapPath((<span class="string">&quot;.\\Uplogpic\\&quot;</span> + fileName)));</span><br><span class="line">                    <span class="keyword">this</span>.ImagePic.ImageUrl = <span class="string">&quot;~/Uplogpic/&quot;</span> + fileName;</span><br><span class="line">                    <span class="keyword">this</span>.lblMessage.Text = <span class="string">&quot;图片上传成功！&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">this</span>.lblMessage.Text = <span class="string">&quot;上传的文件类型不是图片类型文件！&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<h4 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h4><p>与文件上传相对应的是文件下载，各种软件下载网站及视频站点会频繁使用文件下载功能。文件下载有两种办法： 一种是使用 HTML 超链接，在点击链接后下载文件 另一种是使用 ASP.NET 中的 Response 对象以及文件流来处理下载。</p>
<p>使用超链接实现文件下载。</p>
<p>使用示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;fileDown.aspx.cs&quot; Inherits&#x3D;&quot;web3.fileDown&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot;&gt;</span><br><span class="line">&lt;head runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&#x2F;&gt;</span><br><span class="line">    &lt;title&gt;文件下载&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;!-- 按钮需要放在form表单中 --&gt;</span><br><span class="line">    &lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">        &lt;!-- 如果是图片，直接下载会跳到显示图片，需要压缩为压缩包 --&gt;</span><br><span class="line">        &lt;a href&#x3D;&quot;.&#x2F;uploadPic&#x2F;icon_1.png&quot;&gt;下载图片&lt;&#x2F;a&gt;</span><br><span class="line">        &lt;!-- 压缩包下载 --&gt;</span><br><span class="line">        &lt;a href&#x3D;&quot;uploadPic&#x2F;icon_1.zip&quot;&gt;uploadPic&#x2F;icon_1.zip&lt;&#x2F;a&gt;</span><br><span class="line">        &lt;!-- 实现按钮点击下载 --&gt;</span><br><span class="line">        &lt;asp:Button ID&#x3D;&quot;Button1&quot; runat&#x3D;&quot;server&quot; Text&#x3D;&quot;压缩包下载&quot; OnClick&#x3D;&quot;Button1_Click&quot;  &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>如果是下载图片等能够直接通过浏览器打开的文件，需预先将图片压缩成 zip 或 rar 文件，然后再使用超链接指向压缩文件路径，提供下载。</p>
<p>使用TransmitFile() 方法提供文件下载。</p>
<p><strong>使用示例：</strong></p>
<ol>
<li><p>直接通过 a 标签超链接到压缩包就能直接下载</p>
</li>
<li><p>通过使用 Response 对象的 TransmitFile 方法：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Response.ContentType = <span class="string">&quot;application/x-zip-commpressed&quot;</span>;<span class="comment">//MIME</span></span><br><span class="line">         <span class="comment">//文件名</span></span><br><span class="line">         Response.AddHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment;filename=logo.zip&quot;</span>);</span><br><span class="line">         <span class="comment">//物理路径</span></span><br><span class="line">         <span class="built_in">string</span> filename = Server.MapPath(<span class="string">&quot;.\\Uplogpic\\11.zip&quot;</span>);</span><br><span class="line">         <span class="comment">//回传</span></span><br><span class="line">         Response.TransmitFile(filename);</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="TreeView-控件"><a href="#TreeView-控件" class="headerlink" title="TreeView 控件"></a>TreeView 控件</h4><p>各个站点都有导航系统，实现方式是:在页面放置多个超链接，以达到导航到各页面的功能</p>
<p>缺点：分散在多个页面，站点结构发生变化，会使维护繁琐</p>
<h5 id="站点地图"><a href="#站点地图" class="headerlink" title="站点地图"></a>站点地图</h5><p>（1）在 ASP.NET 中，站点地图是以 web.sitemap 命名的文件，且需要存储于站点的根目录下。 </p>
<p>（2）web.sitemap 文件内容是以 XML 所描述的树状结构文件，其中包括了站点的结构信息 </p>
<p>（3）ASP.NET 的导航控件的网站导航信息和超链接的数据均由 web.sitemap 文件提供</p>
<p> 以 web.sitemap 命名的文件，且储存于站点的根目录，其内容是以 XML 所描述的树状结构文件，其中包含的站点的结构信息</p>
<h6 id="主要支持功能："><a href="#主要支持功能：" class="headerlink" title="主要支持功能："></a>主要支持功能：</h6><ol>
<li>采用站点地图作为数据源</li>
<li>使用 XML 文件为数据源</li>
</ol>
<p>siteMapNode 中 url 为跳转地址，title 为标题，description 为描述</p>
<p>在使用 XML 为数据源时，需要选择数据文件，且需要编辑数据绑定，选择需要绑定的数据后修改要显示的字段（TextField）和 导航属性（NavigateUrlField）的来源</p>
<p><strong>需要注意的是，站点地图的名称不能改，默认为Web.sitemap。</strong></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span> ?&gt;</span><br><span class="line">&lt;!-- siteMap:根节点 --&gt;</span><br><span class="line">&lt;siteMap xmlns=<span class="string">&quot;http://schemas.microsoft.com/AspNet/SiteMap-File-1.0&quot;</span> &gt;</span><br><span class="line">  &lt;!-- siteMapNode：对应于页面的节    url:文件路径  title:页面描述  description：说明性文本--&gt;</span><br><span class="line">  &lt;siteMapNode url=<span class="string">&quot;~/index.aspx&quot;</span> title=<span class="string">&quot;资源网&quot;</span>  description=<span class="string">&quot;&quot;</span>&gt;</span><br><span class="line">    &lt;siteMapNode url=<span class="string">&quot;~/login.aspx&quot;</span> title=<span class="string">&quot;登陆&quot;</span>  description=<span class="string">&quot;&quot;</span> /&gt;</span><br><span class="line">    &lt;siteMapNode url=<span class="string">&quot;~/fileDown.aspx&quot;</span> title=<span class="string">&quot;下载&quot;</span>  description=<span class="string">&quot;&quot;</span> /&gt;</span><br><span class="line">  &lt;/siteMapNode&gt;</span><br><span class="line">&lt;/siteMap&gt;</span><br></pre></td></tr></table></figure>

<p><strong>控件使用：</strong></p>
<p>TreeView 控件不常用于显示导航，而是呈现网站后台管理页面的主菜单。可以将 XML 文件作为数据源，编写网站后台管理页面的菜单。</p>
<p><strong>实现步骤如下：</strong> （1）编写 XML 文件 menu.xml，并保存到站点根目录 （2）设置数据源并完成数据源配置信息 （3）编辑数据绑定信息 （4）设置格式</p>
<p><strong>XML格式实现TreeView功能：</strong></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span> ?&gt; </span><br><span class="line">&lt;!-- 需要注意的是 上面的这个xml格式不能删除，也不能在前后加空格，不的话会报错 --&gt;</span><br><span class="line">&lt;!-- 参考站点地图的格式来编写这个xml的TreeView结构 --&gt;</span><br><span class="line">&lt;siteMapNode url=<span class="string">&quot;~/index.aspx&quot;</span> title=<span class="string">&quot;后台管理&quot;</span>  description=<span class="string">&quot;这是一个后台栏目&quot;</span>&gt;</span><br><span class="line">  &lt;siteMapNode url=<span class="string">&quot;~/index.aspx&quot;</span> title=<span class="string">&quot;资源网&quot;</span>  description=<span class="string">&quot;资源网&quot;</span>&gt;</span><br><span class="line">     &lt;siteMapNode url=<span class="string">&quot;~/login.aspx&quot;</span> title=<span class="string">&quot;登陆&quot;</span>  description=<span class="string">&quot;登录&quot;</span> /&gt;</span><br><span class="line">     &lt;siteMapNode url=<span class="string">&quot;~/fileDown.aspx&quot;</span> title=<span class="string">&quot;下载&quot;</span>  description=<span class="string">&quot;下载&quot;</span> /&gt;</span><br><span class="line">  &lt;/siteMapNode&gt;</span><br><span class="line">  &lt;siteMapNode url=<span class="string">&quot;~/index.aspx&quot;</span> title=<span class="string">&quot;订单分类&quot;</span>  description=<span class="string">&quot;这是资源网&quot;</span>&gt;</span><br><span class="line">    &lt;siteMapNode url=<span class="string">&quot;~/login.aspx&quot;</span> title=<span class="string">&quot;衣服&quot;</span>  description=<span class="string">&quot;11登录&quot;</span> /&gt;</span><br><span class="line">    &lt;siteMapNode url=<span class="string">&quot;~/fileDown.aspx&quot;</span> title=<span class="string">&quot;鞋子&quot;</span>  description=<span class="string">&quot;22下载&quot;</span> /&gt;</span><br><span class="line">  &lt;/siteMapNode&gt;</span><br><span class="line">  &lt;siteMapNode url=<span class="string">&quot;~/index.aspx&quot;</span> title=<span class="string">&quot;商品管理&quot;</span>  description=<span class="string">&quot;这是资源网&quot;</span>&gt;</span><br><span class="line">    &lt;siteMapNode url=<span class="string">&quot;~/login.aspx&quot;</span> title=<span class="string">&quot;衣服&quot;</span>  description=<span class="string">&quot;11登录&quot;</span> /&gt;</span><br><span class="line">    &lt;siteMapNode url=<span class="string">&quot;~/fileDown.aspx&quot;</span> title=<span class="string">&quot;鞋子&quot;</span>  description=<span class="string">&quot;22下载&quot;</span> /&gt;</span><br><span class="line">  &lt;/siteMapNode&gt;</span><br><span class="line">&lt;/siteMapNode&gt;</span><br></pre></td></tr></table></figure>

<p>结构内容显示时，需要设置绑定对应的数据。</p>
<h3 id="系统对象"><a href="#系统对象" class="headerlink" title="系统对象"></a>系统对象</h3><p>ASP.NET 中常见的系统对象。</p>
<table>
<thead>
<tr>
<th><strong>对象名</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Page 对象</td>
<td>Page 对象是指向页面自身的方式，在整个页面的执行期内都可以使用该对象</td>
</tr>
<tr>
<td>Request 对象</td>
<td>此对象封装了由 Web 浏览器或其他客户端生成的 HTTP 请求的细节（参数、属性和数据），提供从浏览器读取信息或读取客户端信息等功能，用于页面请求</td>
</tr>
<tr>
<td>Response 对象</td>
<td>此对象封装了返回到 HTTP 客户端的输出，用于向浏览器输出信息或发送指令</td>
</tr>
<tr>
<td>Session 对象</td>
<td>为某个用户提供共享信息，作用于用户会话期</td>
</tr>
<tr>
<td>Cookie 对象</td>
<td>保存在页面客户端的一种储存信息的方式</td>
</tr>
<tr>
<td>Application 对象</td>
<td>为所有用户提供共享信息，作用于整个应用程序运行期</td>
</tr>
<tr>
<td>Server 对象</td>
<td>它提供了服务器端的一些属性和方法，如页面文件的绝对路径等</td>
</tr>
</tbody></table>
<p>每一个 aspx 页面都对应一个页面类，它继承于 System.Web.UI.Page类。Page 对象就是此页面类的实例，即每一个页面就是一个 Page 对象。aspx 页面在运行的过程中被编译为Page 对象，并缓存于服务器内存中。</p>
<h4 id="Page-对象"><a href="#Page-对象" class="headerlink" title="Page 对象"></a>Page 对象</h4><p>页面类的实例，即每个页面就是一个 Page 对象</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>IsPostBack</td>
<td>Bool 值，指示该页面是否为响应客户端回发而加载，或是否为首次加载或访问</td>
</tr>
<tr>
<td>IsValid</td>
<td>Bool 值，至少该页面验证是否成功</td>
</tr>
<tr>
<td>MasterPageFile</td>
<td>用于获取或设置母版页的文件名</td>
</tr>
</tbody></table>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Web;</span><br><span class="line"><span class="keyword">using</span> System.Web.UI;</span><br><span class="line"><span class="keyword">using</span> System.Web.UI.WebControls;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">web3</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">login_page</span> : <span class="title">System.Web.UI.Page</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">Page_Load</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            Response.Write(<span class="string">&quot;哈哈哈！&quot;</span>);</span><br><span class="line">            <span class="comment">//第二次开始的回发判断，如果是回发不要执行里面代码</span></span><br><span class="line">            <span class="keyword">if</span>(!IsPostBack)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>.TextBox1.Text = <span class="string">&quot;请输入用户名&quot;</span>;</span><br><span class="line">                <span class="keyword">this</span>.TextBox2.Text = <span class="string">&quot;请输入密码&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">Button1_Click</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">this</span>.Label1.Text = <span class="string">&quot;您的名字为：&quot;</span>+<span class="keyword">this</span>.TextBox1.Text;</span><br><span class="line">            Response.Write(<span class="string">&quot;&lt;script&gt;alert(&#x27;输入成功！&#x27;);&lt;/script&gt;&quot;</span>);</span><br><span class="line">            Response.Redirect(<span class="string">&quot;~/index.aspx&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Response-对象"><a href="#Response-对象" class="headerlink" title="Response 对象"></a>Response 对象</h4><p>用于将数据从服务器发送回浏览器。允许将数据作为请求的结果发送到浏览器，提供有关的响应信息</p>
<p>可用于页面输入数据和在页面中跳转，还能传递各页面的参数</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Cookies</td>
<td>获取响应的 Cookie 集合</td>
</tr>
<tr>
<td>Redirect</td>
<td>将客户端重新定向到新的 URL</td>
</tr>
<tr>
<td>Write</td>
<td>将信息写入 HTTP 响应输入流</td>
</tr>
</tbody></table>
<p>在页面后台类中，使用 Response 对象的 Write 方法可以动态向页面输出任意文本或标签，但所有的输出内容都从页面第一行位置开始</p>
<p>Write() 方法：Response 对象通过 Write() 方法在页面上输出数据。使用 Write() 方法向页面输出一段文字</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">  if(!this.IsPostBack)</span><br><span class="line">  &#123;</span><br><span class="line">    Response.Write(&quot;ASP.NET，你好！ &quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>除了可以用 Write() 方法输出文字外，还可以用 Write() 方法输出 JavaScript 脚本</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">protected void btnDelete_Click(object sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">  Response.Write(&quot;&lt;script&gt;alert(&#39; 删除成功！ &#39;);&lt;&#x2F;script&gt;&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> Redirect() 方法：Response 对象的 Redirect() 方法可以实现页面重定向的功能，且在重定向到新的 URL 时可以传递参数。</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Response.Redirect(&quot;~&#x2F;index.aspx&quot;);</span><br></pre></td></tr></table></figure>

<h4 id="Request-对象"><a href="#Request-对象" class="headerlink" title="Request 对象"></a>Request 对象</h4><p>用于检索从浏览器向服务器所发送的请求中的信息，提供当前页请求的访问，包括标题，Coookie 和查询字符串</p>
<p>常用的方法</p>
<table>
<thead>
<tr>
<th>属性/方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>QueryString</td>
<td>取得 Get 请求中的数据</td>
</tr>
<tr>
<td>Form</td>
<td>取得 Post 请求中的数据</td>
</tr>
<tr>
<td>Requset</td>
<td>取得 Get 或 Post 请求中的数据</td>
</tr>
</tbody></table>
<ol>
<li><p>Request.QueryString[“参数”] 使用参数为键值取得数据 传值时直接在超链接后添加?参数=值&amp;&amp;….</p>
</li>
<li><p>Requset.Form[“提交控件的 name 值”]和 Requset</p>
<p>使用 post 方法传值时需去掉 from 表单中的 runat 属性，添加 action=”需要提交的页面”，method=”post”</p>
<p> QueryString 属性获取页面间传值。在两个页面之间，URL 参数传值是常见的 Get 传值方式。通过 URL 查询字符串“？ =”的格式语法，将值传递到另一个页面。 QueryString 属性获取页面间传值。</p>
<p>示例：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//通过Request的QueryString方法，获取URL传过来的参数</span></span><br><span class="line">    <span class="keyword">if</span>(Request.QueryString.HasKeys())</span><br><span class="line">    &#123;   </span><br><span class="line">        <span class="comment">//避免类型值转换，获取不到值，值为null的bug解决判断</span></span><br><span class="line">        <span class="built_in">int</span> id = Request.QueryString[<span class="string">&quot;id&quot;</span>] != <span class="literal">null</span> ? <span class="built_in">int</span>.Parse(Request.QueryString[<span class="string">&quot;id&quot;</span>]) : <span class="number">0</span>;</span><br><span class="line">        Response.Write(<span class="string">&quot;当前的值为：&quot;</span> + id);</span><br><span class="line">        <span class="built_in">string</span> s = Request.QueryString[<span class="string">&quot;s&quot;</span>];</span><br><span class="line">        Response.Write(<span class="string">&quot;当前的值为：&quot;</span> + s);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">Page_Load</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!IsPostBack)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//get方法请求</span></span><br><span class="line">        <span class="keyword">if</span>(Request.QueryString[<span class="string">&quot;name&quot;</span>]  != <span class="literal">null</span> &amp;&amp; Request.QueryString[<span class="string">&quot;name&quot;</span>] != <span class="built_in">string</span>.Empty)</span><br><span class="line">        &#123;</span><br><span class="line">            Response.Write(<span class="string">&quot;您的名字是&quot;</span> + Request.QueryString[<span class="string">&quot;name&quot;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Form 属性传值。通过 Form 表单提交的数据（通常是 POST 传值），可以用 Request.Form 属性来获取。</p>
<p>示例：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">Page_Load</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!IsPostBack)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//post方法请求</span></span><br><span class="line">        <span class="keyword">if</span> (Request.Form[<span class="string">&quot;user&quot;</span>] != <span class="literal">null</span> &amp;&amp; Request.Form[<span class="string">&quot;user&quot;</span>] != <span class="built_in">string</span>.Empty)</span><br><span class="line">        &#123;</span><br><span class="line">            Response.Write(<span class="string">&quot;您的名字是&quot;</span> + Request.Form[<span class="string">&quot;user&quot;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Request的综合使用：不管是POST方法请求还是GET方法请求，都可以使用这个方法获取参数。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> user = Request[<span class="string">&quot;userBox&quot;</span>];</span><br><span class="line"><span class="built_in">string</span> pass = Request[<span class="string">&quot;passBox&quot;</span>];</span><br><span class="line"><span class="built_in">string</span> a = Request[<span class="string">&quot;a&quot;</span>];</span><br><span class="line"><span class="built_in">string</span> id = Request[<span class="string">&quot;id&quot;</span>];</span><br><span class="line">Response.Write(<span class="string">&quot;当前的值为：&quot;</span> + user+pass+a+id);</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="Server-对象"><a href="#Server-对象" class="headerlink" title="Server 对象"></a>Server 对象</h4><p>提供对服务器上的方法和属性的访问,用于访问服务器上的资源</p>
<p>其类的名称为 HttpServerUtility</p>
<table>
<thead>
<tr>
<th>属性/方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>HtmlEncode</td>
<td>对字符串进行编码，使在浏览器中正确显示</td>
</tr>
<tr>
<td>HtmlDecode</td>
<td>对已编码的内容进行解码</td>
</tr>
<tr>
<td>MapPath</td>
<td>返回 web 服务器，指定与虚拟路径对应的物理文件路径</td>
</tr>
<tr>
<td>UrlEncode</td>
<td>对 URL 地址进行编码，已保证含有“#”，“&amp;”符号时也能正确识别</td>
</tr>
<tr>
<td>URLDecode</td>
<td>对已编码的 URL 进行解码</td>
</tr>
</tbody></table>
<p>1、MapPath使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Server.MapPath(string path);</span><br></pre></td></tr></table></figure>

<p>path 参数为网站的虚拟路径，如果为 null，则返回站点应用程序所在目录的物理路径</p>
<p>2、HtmlEncode 和 UrlEncode 等的使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">  Server.HtmlEncode:&lt;% Response.Write(Server.HtmlEncode(&quot;&lt;br&gt;&quot;)); %&gt;&lt;br &#x2F;&gt;</span><br><span class="line">  Server.UrlEncode:&lt;% Response.Write(Server.UrlEncode(&quot;defaut.aspx?name&#x3D; 王 &quot;)); %&gt;&lt;br &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br><span class="line"> &lt;% string user &#x3D; Request.Form[&quot;user&quot;]; %&gt;</span><br><span class="line">    &lt;%&#x3D;user %&gt;</span><br><span class="line">    &lt;!-- HTML标签加密原样输出： --&gt;</span><br><span class="line">    &lt;% Response.Write(Server.HtmlEncode(&quot;&lt;br&gt;&quot;)); %&gt;</span><br><span class="line">    &lt;% Response.Write(Server.MapPath(&quot;~&#x2F;&quot;)); %&gt;</span><br><span class="line">    &lt;% &#x2F;&#x2F;Response.Write(Server.UrlEncode(&quot;default.aspx?name&#x3D;张三&quot;)); %&gt;</span><br><span class="line">    &lt;form action&#x3D;&quot;&quot; method&#x3D;&quot;post&quot;&gt;</span><br><span class="line">        名字：&lt;input type&#x3D;&quot;type&quot; name&#x3D;&quot;user&quot; value&#x3D;&quot;&quot; &#x2F;&gt;</span><br><span class="line">        &lt;input type&#x3D;&quot;submit&quot; name&#x3D;&quot;&quot; value&#x3D;&quot;登陆&quot; &#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        var id &#x3D; document.getElementById(&quot;Button1&quot;);</span><br><span class="line">        id.onclick &#x3D; function () &#123;</span><br><span class="line">            alert(&quot;!!&quot;);</span><br><span class="line">        &#125;;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>路径的UrlEncode()和UrlDecode()的使用，使用它的好处是为了防止传输中文出现乱码。 </p>
<h2 id="第5章-页面状态管理"><a href="#第5章-页面状态管理" class="headerlink" title="第5章 页面状态管理"></a>第5章 页面状态管理</h2><h3 id="5-1-Cookie-对象"><a href="#5-1-Cookie-对象" class="headerlink" title="5.1 Cookie 对象"></a>5.1 Cookie 对象</h3><p>在 ASP.NET 中，Cookie 用于在客户端浏览器中存储少量信息，通常存放非敏感的用户信息，保存的时间可以根据用户的需要设置。</p>
<p>语法：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Response.Cookies[“名称”].Value= 值 ;</span><br><span class="line">String 变量名 =Request.Cookies[“名称”].Value;</span><br><span class="line"></span><br><span class="line">示例：</span><br><span class="line">HttpCookie cookie = <span class="keyword">new</span> HttpCookie(“名称”, 值 );</span><br><span class="line">Response.Cookies.Add(cookie);</span><br></pre></td></tr></table></figure>

<p>需要注意：</p>
<p>如果没有设定 Cookie 的过期时间，则 Cookie 的生命周期仅保持到关闭浏览器为止。<strong>如果将过期时间设定为 MaxValue，则 Cookie 永不过期</strong>。由于大多数浏览器对 Cookie 的大小限制为 4KB，所以 Cookie 中不能存储大量数据。<strong>如果浏览器设定了禁用 Cookie，则程序中用到的 Cookie 对象无效</strong>。</p>
<p>使用示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">…</span><br><span class="line">  &lt;% if(Request.Cookies[&quot;UserName&quot;]&#x3D;&#x3D;null) &#123;%&gt;</span><br><span class="line"> …</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;asp:Button ID&#x3D;&quot;btnLogin&quot; runat&#x3D;&quot;server&quot; Text&#x3D;&quot; 登录 &quot; OnClick&#x3D;&quot;btnLogin_Click&quot; &#x2F;&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">  &lt;%&#125;else&#123; %&gt;</span><br><span class="line">  你已经登录，用户名为：&lt;%&#x3D;Request.Cookies[&quot;UserName&quot;].Value  %&gt;</span><br><span class="line">  &lt;%&#125; %&gt;</span><br><span class="line">…</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>后端代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">protected void btnLogin_Click(object sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">  HttpCookie cookie &#x3D; new HttpCookie(&quot;UserName&quot;, this.txtUserName.Text);</span><br><span class="line">  cookie.Expires &#x3D; DateTime.Now.AddDays(3);</span><br><span class="line">  Response.Cookies.Add(cookie);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>COOKIE的两种使用方法：</p>
<p>前端a.aspx页面：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;a.aspx.cs&quot; Inherits&#x3D;&quot;ch3.a&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot;&gt;</span><br><span class="line">&lt;head runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&#x2F;&gt;</span><br><span class="line">    &lt;title&gt;&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            用户名：&lt;asp:TextBox ID&#x3D;&quot;userBox&quot; runat&#x3D;&quot;server&quot;&gt;&lt;&#x2F;asp:TextBox&gt;</span><br><span class="line">            &lt;br &#x2F;&gt;</span><br><span class="line">            密码：&lt;asp:TextBox ID&#x3D;&quot;passBox&quot; runat&#x3D;&quot;server&quot;&gt;&lt;&#x2F;asp:TextBox&gt;</span><br><span class="line">            &lt;br &#x2F;&gt;</span><br><span class="line">            &lt;asp:CheckBox ID&#x3D;&quot;remember&quot; runat&#x3D;&quot;server&quot; &#x2F;&gt;</span><br><span class="line">            记住密码&lt;br &#x2F;&gt;</span><br><span class="line">            &lt;asp:Button ID&#x3D;&quot;btn&quot; runat&#x3D;&quot;server&quot; OnClick&#x3D;&quot;btn_Click&quot; Text&#x3D;&quot;登录&quot; &#x2F;&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>对应的后端代码：a.aspx.cs</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.Web.UI;</span><br><span class="line">using System.Web.UI.WebControls;</span><br><span class="line"></span><br><span class="line">namespace ch3</span><br><span class="line">&#123;</span><br><span class="line">    public partial class a : System.Web.UI.Page</span><br><span class="line">    &#123;</span><br><span class="line">        protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            if(!IsPostBack)</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F;把cookie中的缓存显示到对应的框中</span><br><span class="line">                if(Request.Cookies[&quot;userName&quot;] !&#x3D; null)</span><br><span class="line">                &#123;</span><br><span class="line">                    this.userBox.Text &#x3D; Request.Cookies[&quot;userName&quot;].Value;</span><br><span class="line">                &#125;</span><br><span class="line">                if (Request.Cookies[&quot;passWord&quot;] !&#x3D; null)</span><br><span class="line">                &#123;</span><br><span class="line">                    this.passBox.Text &#x3D; Request.Cookies[&quot;passWord&quot;].Value;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        protected void btn_Click(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;判断当前是否需要记住密码</span><br><span class="line">            if(this.remember.Checked)</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F;1、COOKIE的第一种使用方式：</span><br><span class="line">                &#x2F;&#x2F;cookie缓存用户名，下次登录时，可以直接显示我们的用户名和密码的效果</span><br><span class="line">                Response.Cookies[&quot;userName&quot;].Value &#x3D; this.userBox.Text;</span><br><span class="line">                Response.Cookies[&quot;passWord&quot;].Value &#x3D; this.passBox.Text;</span><br><span class="line"></span><br><span class="line">                &#x2F;&#x2F;可以给缓存加时间</span><br><span class="line">                Response.Cookies[&quot;userName&quot;].Expires &#x3D; DateTime.Now.AddDays(2);</span><br><span class="line">                Response.Cookies[&quot;passWord&quot;].Expires &#x3D; DateTime.Now.AddDays(2);</span><br><span class="line"></span><br><span class="line">                &#x2F;&#x2F;2、COOKIE的第二种使用方式：</span><br><span class="line">                HttpCookie cookie &#x3D; new HttpCookie(&quot;userName&quot;,this.userBox.Text);</span><br><span class="line">                cookie.Expires &#x3D; DateTime.Now.AddDays(2);</span><br><span class="line">                &#x2F;&#x2F;获取cookie值：</span><br><span class="line">                Response.Write(cookie.Value);</span><br><span class="line">            &#125;</span><br><span class="line">            if(this.userBox.Text &#x3D;&#x3D; &quot;zhangsan&quot;)</span><br><span class="line">            &#123;</span><br><span class="line">                Response.Cookies[&quot;userName&quot;].Value &#x3D; &quot;zhangsan&quot;;</span><br><span class="line">                Response.Redirect(&quot;b.aspx&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>跳转的另一个页面：b.aspx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;b.aspx.cs&quot; Inherits&#x3D;&quot;ch3.b&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot;&gt;</span><br><span class="line">&lt;head runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&#x2F;&gt;</span><br><span class="line">    &lt;title&gt;&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div style&#x3D;&quot;width:100%;height:30px;background:#eee;&quot;&gt;</span><br><span class="line">        &lt;% if (Request.Cookies[&quot;userName&quot;] &#x3D;&#x3D; null)</span><br><span class="line">            &#123; %&gt;</span><br><span class="line">        &lt;a href&#x3D;&quot;a.aspx&quot;&gt;登录&lt;&#x2F;a&gt;</span><br><span class="line">        &lt;%&#125;</span><br><span class="line">    else</span><br><span class="line">    &#123; %&gt;</span><br><span class="line">        &lt;a href&#x3D;&quot;#&quot;&gt;&lt;%&#x3D;Request.Cookies[&quot;userName&quot;].Value %&gt;&lt;&#x2F;a&gt;</span><br><span class="line">        &lt;%&#125; %&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<h3 id="5-2-Session-对象"><a href="#5-2-Session-对象" class="headerlink" title="5.2 Session 对象"></a>5.2 Session 对象</h3><p>Session 对象用于存储在多个页面之间传递的特定用户的信息。</p>
<p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">赋值：Session[“名称”]&#x3D; 值 ;</span><br><span class="line">取值：变量 &#x3D;Session[“名称”];</span><br></pre></td></tr></table></figure>

<p>Session 对象有如下特点： （1）Session 对象包含某一个用户的状态信息，此信息仅面向该连接，不与其他用户共享。 （2）当会话超时或过期，服务器会即刻清除 Session 对象，释放所有资源。 （3）会话通过 SessionID 传递状态信息，客户端仅知道 SessionID，但对其状态信息不可见</p>
<p>方法：</p>
<table>
<thead>
<tr>
<th><strong>方法</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Abandon</td>
<td>取消当前会话</td>
</tr>
<tr>
<td>Clear</td>
<td>从会话对象中移除所有的键和值</td>
</tr>
<tr>
<td>Remove</td>
<td>删除会话对象中的项</td>
</tr>
</tbody></table>
<p>示例：UserIndex.aspx 页面页面代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    用户名：&lt;%&#x3D; Session[&quot;UserName&quot;] %&gt;</span><br><span class="line">  &lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;form&gt;</span><br></pre></td></tr></table></figure>

<p>后端代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">protected void btnLogin_Click(object sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">  if (this.txtUserName.Text.Trim() !&#x3D; string.Empty)</span><br><span class="line">  &#123;</span><br><span class="line">    Session[&quot;UserName&quot;] &#x3D; this.txtUserName.Text;</span><br><span class="line">    Response.Redirect(&quot;UserIndex.aspx&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-Application-对象"><a href="#5-3-Application-对象" class="headerlink" title="5.3 Application 对象"></a>5.3 Application 对象</h3><p>Application 对象用于共享应用程序级信息，即多个用户共享一个 Application 对象</p>
<p>语法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">赋值：Application[“名称”]&#x3D; 值 ;</span><br><span class="line">取值：变量 &#x3D; Application[“名称”];</span><br></pre></td></tr></table></figure>

<p>Application 对象与 Session 对象的主要区别是： （1）Session 对象中的数据只能被单个用户在多个页面中访问和修改，会话结束后就不能访问。 （2）Application 对象中的数据能被多个用户在多个页面中访问并修改，会话结束后其他用户还能访问 Application 中的数据，只有 Web 应用程序结束后才能销毁</p>
<p><strong>注意：</strong></p>
<p>只有当所有用户关闭了 Web 应用程序连接后，Web 应用程序才会结束。因为一般这种情况很难遇到，所以保存在Application 中的数据将会在内存中保存很长时间，因此一般不建议将大量数据保存在 Application 对象中。</p>
<p>漂流瓶案例：</p>
<p>前端代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;bottle.aspx.cs&quot; Inherits&#x3D;&quot;web3.bottle&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot;&gt;</span><br><span class="line">&lt;head runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&#x2F;&gt;</span><br><span class="line">    &lt;title&gt;&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            漂流瓶：&lt;asp:TextBox ID&#x3D;&quot;say&quot; runat&#x3D;&quot;server&quot;&gt;&lt;&#x2F;asp:TextBox&gt;</span><br><span class="line">            &lt;asp:Button ID&#x3D;&quot;throws&quot; runat&#x3D;&quot;server&quot; Text&#x3D;&quot;扔一个漂流瓶&quot; OnClick&#x3D;&quot;throws_Click&quot; &#x2F;&gt;</span><br><span class="line">            &lt;asp:Button ID&#x3D;&quot;get&quot; runat&#x3D;&quot;server&quot; Text&#x3D;&quot;捞一个漂流瓶&quot; OnClick&#x3D;&quot;get_Click&quot; &#x2F;&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">    &lt;asp:Label ID&#x3D;&quot;lblMessage&quot; runat&#x3D;&quot;server&quot; Text&#x3D;&quot;&quot;&gt;&lt;&#x2F;asp:Label&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>后端代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.Web.UI;</span><br><span class="line">using System.Web.UI.WebControls;</span><br><span class="line"></span><br><span class="line">namespace web3</span><br><span class="line">&#123;</span><br><span class="line">    public partial class bottle : System.Web.UI.Page</span><br><span class="line">    &#123;</span><br><span class="line">        protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        protected void throws_Click(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;1、先获取输入框中的内容</span><br><span class="line">            string con &#x3D; this.say.Text;</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;2、从Application对象中获取漂流瓶信息</span><br><span class="line">            List&lt;string&gt; list &#x3D; Application[&quot;bottles&quot;] as List&lt;string&gt;;</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;3、如果泛型集合不存在，就生成，并存储内容到泛型集合中</span><br><span class="line">            if(list &#x3D;&#x3D; null)</span><br><span class="line">            &#123;</span><br><span class="line">                list &#x3D; new List&lt;string&gt;();</span><br><span class="line">                list.Add(&quot;捞到一只大螃蟹!&quot;);</span><br><span class="line">                list.Add(&quot;捞到一个鸡腿！&quot;);</span><br><span class="line">                list.Add(&quot;捞到一只鲸鱼哦！&quot;);</span><br><span class="line">                list.Add(&quot;捞到一个蛤蟆！&quot;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;如果内容为空，不要往后执行</span><br><span class="line">            if (con.Trim() &#x3D;&#x3D; string.Empty)</span><br><span class="line">            &#123;</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;4、然后向泛型集合中存储当前发送的内容</span><br><span class="line">            list.Add(con);</span><br><span class="line">            Application[&quot;bottles&quot;] &#x3D; list;</span><br><span class="line">            this.say.Text &#x3D; &quot;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;捞一个漂流瓶，随机取一个信息出来</span><br><span class="line">        protected void get_Click(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            List&lt;string&gt; bottles &#x3D; Application[&quot;bottles&quot;] as List&lt;string&gt;;</span><br><span class="line">            &#x2F;&#x2F;随机取一个值出来</span><br><span class="line">            if(bottles !&#x3D; null)</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F;随机数生成</span><br><span class="line">                Random ran &#x3D; new Random(DateTime.Now.Millisecond);</span><br><span class="line">                &#x2F;&#x2F;随机生成的数，需要小于漂流瓶的长度</span><br><span class="line">                int num &#x3D; ran.Next(bottles.Count);</span><br><span class="line">                &#x2F;&#x2F;随机从泛型集合中取一个值出来</span><br><span class="line">                this.lblMessage.Text &#x3D; bottles[num];</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                this.lblMessage.Text &#x3D; &quot;再努力捞一捞！&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-4-Session-购物车综合案例"><a href="#5-4-Session-购物车综合案例" class="headerlink" title="5.4 Session 购物车综合案例"></a>5.4 Session 购物车综合案例</h3><p>在实际开发过程中，Session 还被广泛运用到购物信息的存储中。</p>
<p>前端商品页面功能：shopCar.aspx页面：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;shopCar.aspx.cs&quot; Inherits&#x3D;&quot;web3.shopCar&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot;&gt;</span><br><span class="line">&lt;head runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&#x2F;&gt;</span><br><span class="line">    &lt;title&gt;&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">        &lt;asp:Literal ID&#x3D;&quot;showShop&quot; runat&#x3D;&quot;server&quot;&gt;&lt;&#x2F;asp:Literal&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>对应的shopCar.aspx页面的ASP.NET代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.Web.UI;</span><br><span class="line">using System.Web.UI.WebControls;</span><br><span class="line"></span><br><span class="line">namespace web3</span><br><span class="line">&#123;</span><br><span class="line">    public partial class shopCar : System.Web.UI.Page</span><br><span class="line">    &#123;</span><br><span class="line">        protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;1、页面初始化时，显示商品列表信息</span><br><span class="line">            Dictionary&lt;int,Goods&gt; shops &#x3D; new Dictionary&lt;int, Goods&gt;();</span><br><span class="line">            &#x2F;&#x2F;向泛型集合中存储商品</span><br><span class="line">            shops.Add(0,new Goods(0,&quot;苹果iphone 12&quot;,9999,&quot;最新最好用的苹果iphone 12手机&quot;));</span><br><span class="line">            shops.Add(1,new Goods(1, &quot;苹果iphone 13&quot;, 13099, &quot;最新最好用的苹果iphone 13手机。买一台吧！&quot;));</span><br><span class="line">            shops.Add(2,new Goods(2, &quot;华为mate 20&quot;, 3999, &quot;华为旗舰机，好不好你说的算！&quot;));</span><br><span class="line">            shops.Add(3,new Goods(3, &quot;华为Nova&quot;, 5999, &quot;华为新款手机&quot;));</span><br><span class="line">            &#x2F;&#x2F;存到Session中</span><br><span class="line">            Session[&quot;shopList&quot;] &#x3D; shops;</span><br><span class="line">            &#x2F;&#x2F;把上面的信息放到页面上展示</span><br><span class="line">            var htmlStr &#x3D; &quot;&lt;table border&#x3D;&#39;1&#39;&gt;&lt;tr&gt;&lt;td&gt; 商品名称 &lt;&#x2F;td&gt;&lt;td&gt; 价格 &lt;&#x2F;td&gt;&lt;td&gt; 介绍 &lt;&#x2F;td&gt;&lt;td&gt; 下单 &lt;&#x2F;td&gt;&lt;&#x2F;tr&gt; &quot;;</span><br><span class="line">            foreach (KeyValuePair&lt;int,Goods&gt; item in shops)</span><br><span class="line">            &#123;</span><br><span class="line">                htmlStr +&#x3D; &quot;&lt;tr&gt;&lt;td&gt; &quot;+item.Value.GoodsName+ &quot; &lt;&#x2F;td&gt;&lt;td&gt; &quot; + item.Value.Price + &quot; &lt;&#x2F;td&gt; &lt;td&gt; &quot; + item.Value.Introduce + &quot; &lt;&#x2F; td&gt;&lt;td&gt; &lt;a href&#x3D;&#39;myCar.aspx?id&#x3D;&quot; + item.Value.GoodsId + &quot;&#39;&gt;加入购物车&lt;&#x2F;a&gt; &lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">            htmlStr +&#x3D; &quot;&lt;&#x2F;table&gt;&quot;;</span><br><span class="line">            showShop.Text &#x3D; htmlStr;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当用户点击了对应商品后，可以跳转到对应的购物车页面下单商品：</p>
<p>myCar.aspx前端页面部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;myCar.aspx.cs&quot; Inherits&#x3D;&quot;web3.myCar&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot;&gt;</span><br><span class="line">&lt;head runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&#x2F;&gt;</span><br><span class="line">    &lt;title&gt;&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;asp:Literal ID&#x3D;&quot;myCarList&quot; runat&#x3D;&quot;server&quot;&gt;&lt;&#x2F;asp:Literal&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>后端页面功能：对应的商品显示的后端代码myCar.aspx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.Web.UI;</span><br><span class="line">using System.Web.UI.WebControls;</span><br><span class="line"></span><br><span class="line">namespace web3</span><br><span class="line">&#123;</span><br><span class="line">    public partial class myCar : System.Web.UI.Page</span><br><span class="line">    &#123;</span><br><span class="line">        protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;查看当前链接是否已经请求过来</span><br><span class="line">            if (Request.QueryString[&quot;id&quot;] !&#x3D; null)</span><br><span class="line">            &#123;</span><br><span class="line">                int id &#x3D; int.Parse(Request.QueryString[&quot;id&quot;]);</span><br><span class="line">                Response.Write(&quot;添加商品成功！&quot;);</span><br><span class="line">                &#x2F;&#x2F;购物车存储格式改为：&lt;商品类,购买的商品数量&gt; 的格式</span><br><span class="line">                Dictionary&lt;Goods, int&gt; car &#x3D; Session[&quot;carList&quot;] as Dictionary&lt;Goods, int&gt;;</span><br><span class="line">                &#x2F;&#x2F;获取商品列表</span><br><span class="line">                Dictionary&lt;int, Goods&gt; list &#x3D; Session[&quot;shopList&quot;] as Dictionary&lt;int, Goods&gt;;</span><br><span class="line">                &#x2F;&#x2F;购物车是否存在Session</span><br><span class="line">                if (car &#x3D;&#x3D; null)</span><br><span class="line">                &#123;</span><br><span class="line">                    &#x2F;&#x2F;如果为空，先实例化</span><br><span class="line">                    car &#x3D; new Dictionary&lt;Goods, int&gt;();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                &#x2F;&#x2F;取到对应商品</span><br><span class="line">                Goods shop &#x3D; list[id];</span><br><span class="line">                &#x2F;&#x2F;查看购物车是否存在这个商品，存在就给它+1，不存在就先从1开始添加</span><br><span class="line">                if (car.ContainsKey(shop))</span><br><span class="line">                &#123;</span><br><span class="line">                    car[shop] &#x3D; car[shop]+1;</span><br><span class="line">                &#125;</span><br><span class="line">                else</span><br><span class="line">                &#123;</span><br><span class="line">                    &#x2F;&#x2F;不存在，先从1开始，再赋值存储到Session替换</span><br><span class="line">                    car.Add(shop, 1);</span><br><span class="line">                    Session[&quot;carList&quot;] &#x3D; car;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            &#x2F;&#x2F;展示商品列表</span><br><span class="line">            showList();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void showList()</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;判断购物车是否存在商品</span><br><span class="line">            Dictionary&lt;Goods, int&gt; car &#x3D; Session[&quot;carList&quot;] as Dictionary&lt;Goods, int&gt;;</span><br><span class="line">            if(car !&#x3D; null)</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F;拼凑HTML,然后显示这个HTML出来</span><br><span class="line">                string html &#x3D; &quot;&lt;table&gt;&lt;tr&gt;&lt;td&gt;商品名称&lt;&#x2F;td&gt;&lt;td&gt;商品价格&lt;&#x2F;td&gt;&lt;td&gt;商品数量&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;</span><br><span class="line">                foreach (KeyValuePair&lt;Goods,int&gt; item in car)</span><br><span class="line">                &#123;</span><br><span class="line">                    html +&#x3D; &quot;&lt;tr&gt;&lt;td&gt;&quot;+item.Key.GoodsName+ &quot;&lt;&#x2F;td&gt;&lt;td&gt;&quot; + item.Key.Price + &quot;&lt;&#x2F;td&gt;&lt;td&gt;&quot; + item.Value + &quot;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">                html +&#x3D; &quot;&lt;&#x2F;table&gt;&quot;;</span><br><span class="line">                myCarList.Text &#x3D; html;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                Response.Write(&quot;购物车空空如也，请先添加商品！&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第6章-三层架构"><a href="#第6章-三层架构" class="headerlink" title="第6章 三层架构"></a>第6章 三层架构</h2><h3 id="6-1-三层架构理解"><a href="#6-1-三层架构理解" class="headerlink" title="6.1 三层架构理解"></a>6.1 三层架构理解</h3><p>分层设计可避免模块间相同功能的重复编写，达到减少模块间的耦合性、提高独立性的系统设计要求。</p>
<p><strong>ASP.NET 站点的设计开发中，通常采用三层架构的设计：</strong> （1）数据访问层：主要用于实现对数据库的访问和操作。 （2）业务逻辑层：主要包含业务逻辑代码以及作为表现层和数据访问层之间的通讯桥梁，负责数据的传递和处理。 （3）表现层：用于显示数据和接收用户输入的数据，为用户提供可以交互的操作界面及表现逻辑。</p>
<p><strong>在项目中使用三层架构的优势如下：</strong> （1）适于变化，利于维护。项目需求经常会发生变化，三层架构将功能模块分离，提高了项目的可维护性和代码的可重用性。 （2）适用于协作开发。目前，多数项目是团队多人协作开发的，有的负责界面设计，有的负责数据库操作模块，三层架构将各个功能模块分离，各自负责各层的模块，有利于协作开发。 （3）主流趋势。在企业级的开发中，三层架构是基本要求，大多数项目都会采用三层架构。</p>
<h3 id="6-2-模型层与数据访问层的搭建"><a href="#6-2-模型层与数据访问层的搭建" class="headerlink" title="6.2 模型层与数据访问层的搭建"></a>6.2 模型层与数据访问层的搭建</h3><p><strong>1、模型层</strong></p>
<p>由于三层之间存在数据交互，所以需要中间介质——模型层，模型层包含所有与数据表相对应的实体类。三层之间通过传输实体类对象来实现通信</p>
<p><strong>（1）. 模型层的命名</strong> 常见的命名方式有 Model、Models 或用解决方案名 +Model 的格式命名。 模型层是单个 C# 类库项目，模型层中的实体类和数据表相对应。</p>
<p><strong>（2）. 实体类结构</strong> 实体类的编写较为简单，只需对应数据表字段编写出实体类的属性即可。 除了构造方法，实体类通常不含其他方法。</p>
<p>注意：由于实体类对象作为层之间数据通信的载体，常需要在不同的场景下执行类型转换，可以使用 Serializable 特性标识实体类为可序列化，以便转换实体类对象。   </p>
<p><strong>2、数据访问层</strong></p>
<p>数据访问层（Data Access Layer，简称 DAL）负责与数据库的交互，运行数据库查询并执行更新</p>
<p><strong>1） 数据访问层的命名</strong> 数据访问层以 DAL 命名或以解决方案名称 +DAL 的格式命名。 数据库中的每张表，在数据访问层都有相对应的数据访问类。</p>
<p><strong>2）数据访问类中的方法</strong> （1）增（Create） （2）删（Delete） （3）改（Update） （4）查（Select）</p>
<p>代码示例：MODELS层代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line"></span><br><span class="line">namespace Models</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F;让一个对象转换为可存储在磁盘上、或可通过网络传输的格式的过程，叫做序列化</span><br><span class="line">    [Serializable]</span><br><span class="line">    public class UserInfo</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;summary&gt;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; 用户编号</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;</span><br><span class="line">        public int userID &#123; get; set; &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;summary&gt;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; 用户姓名  快捷键：prop按两次tab键生成</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;</span><br><span class="line">        public string userName &#123; get; set; &#125;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;summary&gt;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; 用户QQ  快捷键：prop按两次tab键生成</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;</span><br><span class="line">        public string QQ &#123; get; set; &#125;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;summary&gt;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; 用户密码  快捷键：prop按两次tab键生成</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;</span><br><span class="line">        public string password &#123; get; set; &#125;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;summary&gt;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; 手机号  快捷键：prop按两次tab键生成</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;</span><br><span class="line">        public string phone &#123; get; set; &#125;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;summary&gt;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; 地址  快捷键：prop按两次tab键生成</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;</span><br><span class="line">        public string address&#123; get; set; &#125;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;summary&gt;</span><br><span class="line">        &#x2F;&#x2F;&#x2F; 创建时间  快捷键：prop按两次tab键生成</span><br><span class="line">        &#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;</span><br><span class="line">        public DateTime createTime&#123; get; set; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>DAL 项目中添加 UserInfoService 类 （1）添加 DBHelper 类。 （2）编写 UserInfoService 类</p>
<p>DAL（数据访问层）实现代码：【DAL需要和MODELS引用关联，再using MODELS类】</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">using Models;</span><br><span class="line">using System;</span><br><span class="line">using System.Data.SqlClient;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;数据访问层：访问数据模型层</span><br><span class="line">namespace DAL</span><br><span class="line">&#123;</span><br><span class="line">    public class UserInfoService</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F;数据访问层的作用是：针对数据库的某一张表，与之对应在数据访问层创建一个访问类，包含对这个表的增删改查四个方法。</span><br><span class="line">        &#x2F;&#x2F;新增用户方法</span><br><span class="line">        public static bool addUser(UserInfo user)</span><br><span class="line">        &#123;</span><br><span class="line">            string sql &#x3D; &quot;INSERT INTO userInfo(userName,qq,password,phone,address,createTime) VALUES(&#39;&quot; + user.userName + &quot;&#39;,&#39;&quot; + user.QQ + &quot;&#39;,&#39;&quot; + user.password + &quot;&#39;,&#39;&quot; + user.phone + &quot;&#39;,&#39;&quot; + user.address + &quot;&#39;,&#39;&quot; + user.createTime + &quot;&#39;)&quot;;</span><br><span class="line">            return DBHelper.Update(sql);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        &#x2F;&#x2F;删除用户</span><br><span class="line">        public static bool deleteUserById(int userId)</span><br><span class="line">        &#123;</span><br><span class="line">            string sql &#x3D; string.Format(&quot;delete from userInfo where userId&#x3D;&#39;&#123;0&#125;&#39;&quot;, userId);</span><br><span class="line">            return DBHelper.Update(sql);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;修改用户</span><br><span class="line">        public static bool updateUserInfo(UserInfo user)</span><br><span class="line">        &#123;</span><br><span class="line">            string sql &#x3D; string.Format(&quot;update userInfo set userName&#x3D;&#39;&#123;0&#125;&#39;,qq&#x3D;&#39;&#123;1&#125;&#39;,password&#x3D;&#39;&#123;2&#125;&#39;,phone&#x3D;&#39;&#123;3&#125;&#39;,address&#x3D;&#39;&#123;4&#125;&#39;,createTime&#x3D;&#39;&#123;5&#125;&#39; where userId&#x3D;&#39;&#123;6&#125;&#39;&quot;,user.userName,user.QQ,user.password,user.phone,user.address,user.createTime,user.userID);</span><br><span class="line">            return DBHelper.Update(sql);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        &#x2F;&#x2F;查询用户</span><br><span class="line">        public static UserInfo getUserInfoById(int userID)</span><br><span class="line">        &#123;</span><br><span class="line">            string sql &#x3D; &quot;select * from userInfo where userId&#x3D;&quot;+userID;</span><br><span class="line">            SqlDataReader dr &#x3D; DBHelper.GetReader(sql);</span><br><span class="line">            UserInfo user &#x3D; null;</span><br><span class="line">            if(dr.Read())</span><br><span class="line">            &#123;</span><br><span class="line">                user &#x3D; new UserInfo();</span><br><span class="line">                &#x2F;&#x2F;下面这种通过数组下标取值有个不好的地方是，取出来的值是object类型，需要转换类型</span><br><span class="line">                &#x2F;&#x2F; user.userID &#x3D; Convert.ToInt32(dr[&quot;userID&quot;]);&#x2F;&#x2F;可以这样的格式转换</span><br><span class="line">                &#x2F;&#x2F;也支持下面的格式：</span><br><span class="line">                user.userID &#x3D; dr.GetInt32(0); &#x2F;&#x2F;0为取出来时的数组下标</span><br><span class="line">                user.userName &#x3D; dr.GetString(1);</span><br><span class="line">                user.QQ &#x3D; dr.GetString(2);</span><br><span class="line">                user.password &#x3D; dr.GetString(3);</span><br><span class="line">                user.phone &#x3D; dr.GetString(4);</span><br><span class="line">                user.address &#x3D; dr.GetString(5);</span><br><span class="line">                user.createTime &#x3D; dr.GetDateTime(6);</span><br><span class="line">            &#125;</span><br><span class="line">            &#x2F;&#x2F;关闭读</span><br><span class="line">            dr.Close();</span><br><span class="line">            return user;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>DBHelper类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Text;</span><br><span class="line">using System.Data.SqlClient;</span><br><span class="line">using System.Data;</span><br><span class="line"></span><br><span class="line">namespace DAL</span><br><span class="line">&#123;</span><br><span class="line">    class DBHelper</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F;连接配置项</span><br><span class="line">        public static string conStr &#x3D; &quot;server&#x3D;.;database&#x3D;FreshLive;uid&#x3D;sa;pwd&#x3D;JSB903..&quot;;</span><br><span class="line">        &#x2F;&#x2F;连接对象</span><br><span class="line">        public static SqlConnection conn &#x3D; null;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;连接对象</span><br><span class="line">        public static void Open()</span><br><span class="line">        &#123;</span><br><span class="line">            if(conn &#x3D;&#x3D; null)</span><br><span class="line">            &#123;</span><br><span class="line">                conn &#x3D; new SqlConnection(conStr);</span><br><span class="line">            &#125;</span><br><span class="line">            if(conn.State &#x3D;&#x3D; ConnectionState.Closed)</span><br><span class="line">            &#123;</span><br><span class="line">                conn.Open();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;获取数据到表格</span><br><span class="line">        public static DataTable GetData(string sql)</span><br><span class="line">        &#123;</span><br><span class="line">            Open();</span><br><span class="line">            SqlDataAdapter sa &#x3D; new SqlDataAdapter(sql,conn);</span><br><span class="line">            DataTable dt &#x3D; new DataTable();</span><br><span class="line">            sa.Fill(dt);</span><br><span class="line">            return dt;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;获取单条数据</span><br><span class="line">        public static SqlDataReader GetReader(string sql)</span><br><span class="line">        &#123;</span><br><span class="line">            Open();</span><br><span class="line">            &#x2F;&#x2F;先开启连接对象</span><br><span class="line">            SqlCommand cmd &#x3D; new SqlCommand(sql,conn);</span><br><span class="line">            &#x2F;&#x2F;执行读的方法</span><br><span class="line">            SqlDataReader reader &#x3D; cmd.ExecuteReader();</span><br><span class="line">            return reader;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;增删改</span><br><span class="line">        public static bool Update(string sql)</span><br><span class="line">        &#123;</span><br><span class="line">            Open();</span><br><span class="line">            SqlCommand cmd &#x3D; new SqlCommand(sql,conn);</span><br><span class="line">            int result &#x3D; cmd.ExecuteNonQuery();</span><br><span class="line">            return result &gt; 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-3-业务层的搭建以及与数据层之间的调用"><a href="#6-3-业务层的搭建以及与数据层之间的调用" class="headerlink" title="6.3 业务层的搭建以及与数据层之间的调用"></a>6.3 业务层的搭建以及与数据层之间的调用</h3><p>业务逻辑层（Business Logic Layer，简称 BLL）包含一系列执行于数据上的操作</p>
<ol>
<li>业务逻辑层的命名 业务逻辑层通常命名为 BLL 或用解决方案名称 +BLL 的格式命名。 每个实体类通常在业务逻辑层有对应的业务逻辑类。类的格式为实体类名称 +Manager。</li>
<li>业务逻辑层的方法 每个业务逻辑类的方法用于处理具体的业务规则</li>
</ol>
<p>使用示例：DAL服务访问层代码：新增下面的方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;通过用户名查询用户</span><br><span class="line">public static UserInfo getUserInfoByUserName(string userName)</span><br><span class="line">&#123;</span><br><span class="line">    string sql &#x3D; &quot;select * from userInfo where userName&#x3D;&quot; + userName;</span><br><span class="line">    SqlDataReader dr &#x3D; DBHelper.GetReader(sql);</span><br><span class="line">    UserInfo user &#x3D; null;</span><br><span class="line">    if (dr.Read())</span><br><span class="line">    &#123;</span><br><span class="line">        user &#x3D; new UserInfo();</span><br><span class="line">        user.userID &#x3D; dr.GetInt32(0); &#x2F;&#x2F;0为取出来时的数组下标</span><br><span class="line">        user.userName &#x3D; dr.GetString(1);</span><br><span class="line">        user.QQ &#x3D; dr.GetString(2);</span><br><span class="line">        user.password &#x3D; dr.GetString(3);</span><br><span class="line">        user.phone &#x3D; dr.GetString(4);</span><br><span class="line">        user.address &#x3D; dr.GetString(5);</span><br><span class="line">        user.createTime &#x3D; dr.GetDateTime(6);</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;关闭读</span><br><span class="line">    dr.Close();</span><br><span class="line">    return user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BLL业务逻辑层代码：【需要把DAL数据访问层、MODELS模型层都引入，并使用类库】</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">using DAL;</span><br><span class="line">using Models;</span><br><span class="line">using System;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;业务层</span><br><span class="line">namespace BLL</span><br><span class="line">&#123;</span><br><span class="line">    public class UserInfoManager</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F;业务逻辑层也涉及4个方法，增删改查用户信息</span><br><span class="line">        &#x2F;&#x2F;注册用户</span><br><span class="line">        public static bool RegisterUser(UserInfo user)</span><br><span class="line">        &#123;</span><br><span class="line">            return UserInfoService.addUser(user);</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F;删除用户</span><br><span class="line">        public static bool DeleteUser(int userId)</span><br><span class="line">        &#123;</span><br><span class="line">            return UserInfoService.deleteUserById(userId);</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F;修改用户</span><br><span class="line">        public static bool UpdateUser(UserInfo user)</span><br><span class="line">        &#123;</span><br><span class="line">            return UserInfoService.updateUserInfo(user);</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F;查询用户</span><br><span class="line">        public static UserInfo getUserInfoById(int userId)</span><br><span class="line">        &#123;</span><br><span class="line">            return UserInfoService.getUserInfoById(userId);</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F;判断用户登录是否成功</span><br><span class="line">        public static bool checkUser(string userName,string passWord)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;通过用户名获取用户信息回来</span><br><span class="line">            UserInfo user &#x3D; UserInfoService.getUserInfoByUserName(userName);</span><br><span class="line">            if (user &#x3D;&#x3D; null)</span><br><span class="line">                return false;</span><br><span class="line">            &#x2F;&#x2F;用户存在，判断密码是否正确</span><br><span class="line">            return user.password &#x3D;&#x3D; passWord;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-4-表现层以及三层调用"><a href="#6-4-表现层以及三层调用" class="headerlink" title="6.4 表现层以及三层调用"></a>6.4 表现层以及三层调用</h3><p>表现层由两个主要组件组成，分别是用户界面和表现层逻辑（UI 逻辑） 用户界面为用户提供了使用程序的接口，程序的所有行为均通过用户界面中的图形化元素或文本元素展现给用户。 表现层给予用户直观的操作体验，对站点而言，界面的美观和易用非常重要。</p>
<ol>
<li>表现层的命名 通常以解决方案名称 +Web 格式命名，或用解决方案名称 +UI 格式命名。</li>
<li>表现层的方法 表现层的方法主要是控件的事件处理方法，以及适用于整个站点的通用方法</li>
</ol>
<p>使用步骤： （1）新建 FreshLiveWeb 项目到当前的 FreshLive 三层架构项目中。 （2）选择 FreshLiveWeb 项目的“引用”，单击鼠标右键添加引用 （3）在 FreshLiveWeb 项目中新建 MiniSite.Master 母版页 （4）选择 FreshLiveWeb 项目 （5）在创建完毕的 Login.aspx 页面中完成页面设计 （6）在 Login.aspx 页面上添加验证控件</p>
<p>项目综合使用示例：【下面为表现层的登陆页面】</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Title&#x3D;&quot;生鲜生活登录&quot; Language&#x3D;&quot;C#&quot; MasterPageFile&#x3D;&quot;~&#x2F;Index.Master&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;Login.aspx.cs&quot; Inherits&#x3D;&quot;FreshLiveWeb.Login&quot; %&gt;</span><br><span class="line">&lt;asp:Content ID&#x3D;&quot;Content1&quot; ContentPlaceHolderID&#x3D;&quot;head&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;&#x2F;asp:Content&gt;</span><br><span class="line">&lt;asp:Content ID&#x3D;&quot;Content2&quot; ContentPlaceHolderID&#x3D;&quot;ContentPlaceHolder1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">    &lt;!-- 上面这个是母版页的部分，母版页的占位 --&gt;</span><br><span class="line">&lt;!-- 子页内容区 --&gt;</span><br><span class="line">        用户名：&lt;asp:TextBox ID&#x3D;&quot;userName&quot; runat&#x3D;&quot;server&quot;&gt;&lt;&#x2F;asp:TextBox&gt;</span><br><span class="line">        &lt;asp:RequiredFieldValidator ID&#x3D;&quot;RequiredFieldValidator1&quot; runat&#x3D;&quot;server&quot; ErrorMessage&#x3D;&quot;用户名不能为空！&quot; ForeColor&#x3D;&quot;Red&quot; ControlToValidate&#x3D;&quot;userName&quot;&gt;*&lt;&#x2F;asp:RequiredFieldValidator&gt;</span><br><span class="line">        &lt;br &#x2F;&gt;</span><br><span class="line">        密 码：&lt;asp:TextBox ID&#x3D;&quot;passWord&quot; runat&#x3D;&quot;server&quot; MaxLength&#x3D;&quot;16&quot; TextMode&#x3D;&quot;Password&quot;&gt;&lt;&#x2F;asp:TextBox&gt;</span><br><span class="line">        &lt;asp:RequiredFieldValidator ID&#x3D;&quot;RequiredFieldValidator2&quot; runat&#x3D;&quot;server&quot; ErrorMessage&#x3D;&quot;密码不能为空！&quot; ForeColor&#x3D;&quot;Red&quot; ControlToValidate&#x3D;&quot;passWord&quot;&gt;*&lt;&#x2F;asp:RequiredFieldValidator&gt;</span><br><span class="line">        &lt;asp:ValidationSummary ID&#x3D;&quot;ValidationSummary1&quot; runat&#x3D;&quot;server&quot; &#x2F;&gt;</span><br><span class="line">        &lt;br &#x2F;&gt;</span><br><span class="line">        &lt;asp:Button ID&#x3D;&quot;Button1&quot; runat&#x3D;&quot;server&quot; OnClick&#x3D;&quot;Button1_Click&quot; Text&#x3D;&quot;登录&quot; &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;asp:Content&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>错误说明：</strong></p>
<p><strong>（1）使用asp.net报下面的错误：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WebForms UnobtrusiveValidationMode 需要“jquery”ScriptResourceMapping。请添加一个名为 jquery (区分大小写)的 ScriptResourceMapping。</span><br></pre></td></tr></table></figure>

<p>处理方法：</p>
<p>找到Web.config文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;system.web&gt;</span><br><span class="line">  &lt;compilation debug&#x3D;&quot;true&quot; targetFramework&#x3D;&quot;4.7.2&quot;&#x2F;&gt;</span><br><span class="line">  &lt;httpRuntime targetFramework&#x3D;&quot;4.7.2&quot;&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;system.web&gt;</span><br></pre></td></tr></table></figure>

<p>删除下面这句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;httpRuntime targetFramework&#x3D;&quot;4.7.2&quot;&#x2F;&gt;</span><br></pre></td></tr></table></figure>

<p>在刷新项目即可。这是因为最新版本中，自带的校验插件，缺少Jquery库文件。</p>
<p><strong>（2）错误：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">未能加载文件或程序集“System.Data.SqlClient, Version&#x3D;4.6.1.1, Culture&#x3D;neutral, PublicKeyToken&#x3D;b03f5f7f11d50a3a”</span><br></pre></td></tr></table></figure>

<p>原因是因为选择的类库不是.framework类库，而是.core类库导致的。需要删除重新创建。</p>
<p><strong>（3）错误：列名无效，这是因为SQL语句写错了。自己去查看是不是没有给值加单引号。</strong></p>
<h2 id="第7章-数据绑定控件（一）"><a href="#第7章-数据绑定控件（一）" class="headerlink" title="第7章 数据绑定控件（一）"></a>第7章 数据绑定控件（一）</h2><h3 id="7-1-数据绑定控件"><a href="#7-1-数据绑定控件" class="headerlink" title="7.1 数据绑定控件"></a>7.1 数据绑定控件</h3><p>1、数据绑定控件简介</p>
<p>（1）数据绑定是 ASP.NET 提供的另一种访问数据库的方法，让开发人员不关注数据库连接及命令、如何格式化数据显示在页面上的环节，而是直接把数据绑定到 HTML 元素和 Web 控件中。</p>
<p>（2）数据绑定控件分为列表型控件、表格型控件和层次型控件几种。</p>
<p>所有的数据绑定控件都从 BaseDataBoundControl 抽象类派生，它的重要属性和重要方法如下：</p>
<table>
<thead>
<tr>
<th><strong>属性</strong> <strong>/</strong> <strong>方法</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>DataSource</td>
<td>指定控件的数据来源，程序会从该数据源中获取数据并显示</td>
</tr>
<tr>
<td>DataBind()</td>
<td>显示绑定的数据</td>
</tr>
</tbody></table>
<p>ASP.NET提供了大量数据绑定控件，常用数据绑定控件如下：</p>
<table>
<thead>
<tr>
<th><strong>数据绑定控件</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>DropDownList</td>
<td>下拉数据绑定控件</td>
</tr>
<tr>
<td>Repeater</td>
<td>容器控件，用于生成各个子项的列表，不支持分页、排序和编辑，仅提供重复模板内容</td>
</tr>
<tr>
<td>GridView</td>
<td>以表格的形式进行数据展示，有自带分页，支持删、改、排序、分页</td>
</tr>
<tr>
<td>DetailsView</td>
<td>DetailsView 控件以表格形式显示数据，且一次仅显示数据源的单条记录</td>
</tr>
<tr>
<td>DataList</td>
<td>用于显示限制于该控件项目的重复列表，默认地在数据项目上添加表格，且具有内置样式设置</td>
</tr>
<tr>
<td>ListView</td>
<td>按照编程者编写的模板显示数据，提供增、删、改、排序和分页等功能</td>
</tr>
<tr>
<td>FormView</td>
<td>FormView 控件仅可显示数据源中的单条记录</td>
</tr>
</tbody></table>
<p>2、数据绑定的原理</p>
<p>数据绑定的原理如下： （1）设置控件的数据源和数据的显示格式 （2）设置完成后，控件就会自动处理剩余的工作以把要显示的数据按照要显示的格式显示在页面上。</p>
<p>3、数据绑定的类型</p>
<p>数据绑定的类型分为两种： 第一种：单值绑定方式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%&#x3D;XXX %&gt;：内联引用方式，可以引用 C# 代码</span><br><span class="line">&lt;%# XXX %&gt;：可以引用 .cs 文件中的代码的字段，但这个字段必须在初始化后，在页面的 Load 事件中使用 Page.DataBind 方法来实现</span><br><span class="line">&lt;%#$ XXX %&gt;：可以引用 Web.config 文件中预定义的字段或者已注册的类</span><br><span class="line">&lt;%# Eval(XXX) %&gt;：类似于 JavaScript，数据源也需要绑定</span><br></pre></td></tr></table></figure>

<p>使用示例：</p>
<p>前端使用代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;bind.aspx.cs&quot; Inherits&#x3D;&quot;web3.bind&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot;&gt;</span><br><span class="line">&lt;head runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&#x2F;&gt;</span><br><span class="line">    &lt;title&gt;&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;!-- 直接输出后台绑定的数据 --&gt;</span><br><span class="line">            &lt;%&#x3D;txt %&gt;</span><br><span class="line">            &lt;!-- 不支持配合label标签一起使用 --&gt;</span><br><span class="line">            &lt;asp:Label ID&#x3D;&quot;Label2&quot; runat&#x3D;&quot;server&quot; Text&#x3D;&quot;&lt;%&#x3D;txt %&gt;&quot; ForeColor&#x3D;&quot;Red&quot;&gt;&lt;&#x2F;asp:Label&gt;</span><br><span class="line">            &lt;!-- 直接求解表达式 --&gt;</span><br><span class="line">            &lt;%#1+2 %&gt;</span><br><span class="line">            &lt;asp:Label ID&#x3D;&quot;Label3&quot; runat&#x3D;&quot;server&quot; Text&#x3D;&quot;&lt;%#1+2 %&gt;&quot; ForeColor&#x3D;&quot;Red&quot;&gt;&lt;&#x2F;asp:Label&gt;</span><br><span class="line">            &lt;!-- 输出Web.config的信息,不支持这样的格式直接使用，需要赋值使用 &lt; % $ appSettings:doc % &gt;--&gt;</span><br><span class="line">            &lt;asp:Label ID&#x3D;&quot;Label1&quot; runat&#x3D;&quot;server&quot; Text&#x3D;&quot;&lt;%$ appSettings:doc %&gt;&quot; ForeColor&#x3D;&quot;Red&quot;&gt;&lt;&#x2F;asp:Label&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>Web.config新增的代码，对应&lt;%$ xxx %&gt;的使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 设置配置信息，用于绑定数据显示 --&gt;</span><br><span class="line">&lt;appSettings&gt;</span><br><span class="line">  &lt;add key&#x3D;&quot;doc&quot; value&#x3D;&quot;哈哈哈！配置信息显示哦！&quot; &#x2F;&gt;</span><br><span class="line">&lt;&#x2F;appSettings&gt;</span><br></pre></td></tr></table></figure>

<p>后端对应代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.Web.UI;</span><br><span class="line">using System.Web.UI.WebControls;</span><br><span class="line"></span><br><span class="line">namespace web3</span><br><span class="line">&#123;</span><br><span class="line">    public partial class bind : System.Web.UI.Page</span><br><span class="line">    &#123;</span><br><span class="line">        protected string txt &#x3D; &quot;&quot;;</span><br><span class="line">        protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            txt &#x3D; &quot;你很漂亮！&quot;;</span><br><span class="line">            &#x2F;&#x2F;绑定数据到前端显示</span><br><span class="line">            DataBind();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>单值绑定的优缺点： 优点 （1）简单，灵活 （2）可以在页面上随意数据绑定，方便 缺点 （1）数据绑定的代码和界面标签混合在一起，不方便管理和维护 （2）代码过于分散，使得不同的程序员很难在同一个项目上协同工作</p>
<p>注意：</p>
<p><strong>为了避免代码与 HTML 混用和便于管理，可以在后台代码中以赋值的方式替代单值数据绑定，在页面的 Load 事件中对控件进行赋值</strong></p>
<p>数据绑定的类型分为两种： 第二种：多值绑定方式 多值绑定可以显示一个表中的所有内容，同单值绑定不一样，这种类型的数据绑定需要支持它的特殊控件</p>
<p>4、数据绑定的工作方式：</p>
<p>（1）使用单值数据绑定时，需要把数据绑定表达式插入到 .aspx文件的标记中。使用多值数据绑定时，必须设置一个数据控件的单个或多个属性。 （2）在页面的 Load 事件中调用 DataBind() 方法可以激活数据绑定功能，否则ASP.NET将忽略数据绑定，页面上以空的形式呈现。</p>
<p>注意：</p>
<p><strong>如果数据绑定表达式作为属性的值，最外层使用双引号或单引号都可以。</strong></p>
<p><strong>如果表达式中出现双引号，则最外层最好使用单引号</strong></p>
<h3 id="7-2-DropDownList-控件"><a href="#7-2-DropDownList-控件" class="headerlink" title="7.2 DropDownList 控件"></a>7.2 DropDownList 控件</h3><p>DropDownList 控件用于显示只能选择一项的下拉列表框，在客户端被解释成  的 HTML 标记。常见属性如下：</p>
<table>
<thead>
<tr>
<th><strong>属性名</strong></th>
<th><strong>作用</strong></th>
</tr>
</thead>
<tbody><tr>
<td>AutoPostBack</td>
<td>设置当下拉列表项发生变化时，是否主动向服务器提交整个表单，默认是 false，即不主动提交，为true则触发SelectedIndexChanged事件</td>
</tr>
<tr>
<td>DataTextField</td>
<td>设置列表项的可见部分的文字</td>
</tr>
<tr>
<td>DataValueField</td>
<td>设置列表项的值部分</td>
</tr>
<tr>
<td>Items</td>
<td>获取控件的列表项的集合</td>
</tr>
<tr>
<td>SelectedIndex</td>
<td>获取或设置 DropDownList 控件中的选定项的索引</td>
</tr>
<tr>
<td>SelectedItem</td>
<td>获取列表控件中的选定项</td>
</tr>
<tr>
<td>SelectedValue</td>
<td>取列表控件中选定项的值</td>
</tr>
</tbody></table>
<p>通过下面的案例，我们简单的实现这个功能：</p>
<p>1、首先创建一个商品类：ProductList.cs文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line"></span><br><span class="line">namespace web3</span><br><span class="line">&#123;</span><br><span class="line">    public class ProductList</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F;商品类</span><br><span class="line">        private int shopId;</span><br><span class="line">        private string shopName;</span><br><span class="line">        private decimal price;</span><br><span class="line"></span><br><span class="line">        public int ShopId &#123; get &#x3D;&gt; shopId; set &#x3D;&gt; shopId &#x3D; value; &#125;</span><br><span class="line">        public string ShopName &#123; get &#x3D;&gt; shopName; set &#x3D;&gt; shopName &#x3D; value; &#125;</span><br><span class="line">        public decimal Price &#123; get &#x3D;&gt; price; set &#x3D;&gt; price &#x3D; value; &#125;</span><br><span class="line"></span><br><span class="line">        public ProductList(int id, string shopName,decimal price)</span><br><span class="line">        &#123;</span><br><span class="line">            this.ShopId &#x3D; id;</span><br><span class="line">            this.ShopName &#x3D; shopName;</span><br><span class="line">            this.Price &#x3D; price;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、创建前端页面代码：drop.aspx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;drop.aspx.cs&quot; Inherits&#x3D;&quot;web3.drop&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot;&gt;</span><br><span class="line">&lt;head runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&#x2F;&gt;</span><br><span class="line">    &lt;title&gt;&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;asp:DropDownList ID&#x3D;&quot;proList&quot; runat&#x3D;&quot;server&quot;&gt;&lt;&#x2F;asp:DropDownList&gt;</span><br><span class="line">        &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>前端页面对应的后端代码：drop.aspx.cs</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.Web.UI;</span><br><span class="line">using System.Web.UI.WebControls;</span><br><span class="line"></span><br><span class="line">namespace web3</span><br><span class="line">&#123;</span><br><span class="line">    public partial class drop : System.Web.UI.Page</span><br><span class="line">    &#123;</span><br><span class="line">        protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;初始化加载这些数据回来</span><br><span class="line">            if(!IsPostBack)</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F;不是回发的时候，把数据获取回来展示到列表中来</span><br><span class="line">                showList();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void showList()</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F; ProductList pl &#x3D; new ProductList(1,&quot;可口可乐&quot;,8.5M);</span><br><span class="line">            List&lt;ProductList&gt; list &#x3D; new List&lt;ProductList&gt;();</span><br><span class="line">            list.Add(new ProductList(1, &quot;可口可乐&quot;, 8.5M));</span><br><span class="line">            list.Add(new ProductList(2, &quot;雪碧&quot;, 7.5M));</span><br><span class="line">            list.Add(new ProductList(3, &quot;牛奶&quot;, 10.5M));</span><br><span class="line">            &#x2F;&#x2F;多行文本值绑定</span><br><span class="line">            this.proList.DataSource &#x3D; list;</span><br><span class="line">            this.proList.DataTextField &#x3D; &quot;ShopName&quot;;</span><br><span class="line">            this.proList.DataValueField &#x3D; &quot;ShopId&quot;;</span><br><span class="line">            &#x2F;&#x2F;绑定数据</span><br><span class="line">            DataBind();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最终运行可以看到多一个下拉框显示结果。</p>
<h3 id="7-3-DataList-控件"><a href="#7-3-DataList-控件" class="headerlink" title="7.3 DataList 控件"></a>7.3 DataList 控件</h3><p>DataList 控件使用模板定义样式来显示数据，并执行数据的选择、删除和编辑。 DataList 控件最大的特点是通过模板来定义数据的显示格式，DataList 可以在一行显示多条记录。 （1）多行多列数据（即表格类型的数据）的展示，选择 GridView 控件 （2）单行多列或多行单列数据的展示，则使用 DataList 控件或 Repeater 控件</p>
<p>DataList 支持多种模板，必须使用的模板是 ItemTemplate。 DataList 的两个重要属性：</p>
<table>
<thead>
<tr>
<th><strong>属性名</strong></th>
<th><strong>作用</strong></th>
</tr>
</thead>
<tbody><tr>
<td>RepeatColumns</td>
<td>DataList 中显示的列数，默认是 0</td>
</tr>
<tr>
<td>RepeatDirection</td>
<td>DataList 的显示方式有 Horizontal 和 Vertical 两个值，分别代表水平和垂直显示</td>
</tr>
</tbody></table>
<p>前端Datalist.aspx页面代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;Datalist.aspx.cs&quot; Inherits&#x3D;&quot;web3.Datalist&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot;&gt;</span><br><span class="line">&lt;head runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&#x2F;&gt;</span><br><span class="line">    &lt;title&gt;&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;style type&#x3D;&quot;text&#x2F;css&quot;&gt;</span><br><span class="line">        .auto-style1 &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;&#x2F;style&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">        &lt;%--  RepeatColumns&#x3D;&quot;5&quot; 表示一行放多少个，如果是 RepeatDirection意思是怎么排 --%&gt;</span><br><span class="line">        &lt;asp:DataList ID&#x3D;&quot;daList&quot; runat&#x3D;&quot;server&quot; RepeatDirection&#x3D;&quot;Horizontal&quot;&gt;</span><br><span class="line">            &lt;ItemTemplate&gt;</span><br><span class="line">                &lt;table class&#x3D;&quot;auto-style1&quot;&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;</span><br><span class="line">                            &lt;!-- 拼接一个商品图片路径回来 --&gt;</span><br><span class="line">                            &lt;asp:Image ID&#x3D;&quot;Image1&quot; runat&#x3D;&quot;server&quot; ImageUrl&#x3D;&#39;&lt;%# &quot;~&#x2F;ProductPic&#x2F;&quot; + Eval(&quot;ShopId&quot;)+&quot;.jpg&quot; %&gt;&#39; &#x2F;&gt;</span><br><span class="line">                        &lt;&#x2F;td&gt;</span><br><span class="line">                    &lt;&#x2F;tr&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;</span><br><span class="line">                            &lt;asp:Label ID&#x3D;&quot;Label1&quot; runat&#x3D;&quot;server&quot; Text&#x3D;&#39;&lt;%# Eval(&quot;ShopName&quot;) %&gt;&#39;&gt;&lt;&#x2F;asp:Label&gt;</span><br><span class="line">                        &lt;&#x2F;td&gt;</span><br><span class="line">                    &lt;&#x2F;tr&gt;</span><br><span class="line">                    &lt;tr&gt;</span><br><span class="line">                        &lt;td&gt;</span><br><span class="line">                            &lt;!-- &#123;0:c2&#125;，c表示的是这个值是货币，并且保留两位小数，这个￥不能直接拼接在Text的单引号内 --&gt;</span><br><span class="line">                            &lt;asp:Label ID&#x3D;&quot;Label2&quot; runat&#x3D;&quot;server&quot; Text&#x3D;&#39;&lt;%# Eval(&quot;Price&quot;,&quot;&#123;0:c2&#125;&quot;) %&gt;&#39;&gt;&lt;&#x2F;asp:Label&gt;</span><br><span class="line">                        &lt;&#x2F;td&gt;</span><br><span class="line">                    &lt;&#x2F;tr&gt;</span><br><span class="line">                &lt;&#x2F;table&gt;</span><br><span class="line">            &lt;&#x2F;ItemTemplate&gt;</span><br><span class="line">        &lt;&#x2F;asp:DataList&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>后端对应逻辑代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.Web.UI;</span><br><span class="line">using System.Web.UI.WebControls;</span><br><span class="line"></span><br><span class="line">namespace web3</span><br><span class="line">&#123;</span><br><span class="line">    public partial class Datalist : System.Web.UI.Page</span><br><span class="line">    &#123;</span><br><span class="line">        protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            if(!IsPostBack)</span><br><span class="line">            &#123;</span><br><span class="line">                getDataList();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void getDataList()</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;商品列表</span><br><span class="line">            List&lt;ProductList&gt; list &#x3D; new List&lt;ProductList&gt;();</span><br><span class="line">            &#x2F;&#x2F;添加商品到商品列表中</span><br><span class="line">            list.Add(new ProductList(1, &quot;可口可乐&quot;, 8.5M));</span><br><span class="line">            list.Add(new ProductList(2, &quot;雪碧&quot;, 7.5M));</span><br><span class="line">            list.Add(new ProductList(3, &quot;牛奶&quot;, 10.5M));</span><br><span class="line">            list.Add(new ProductList(4, &quot;苹果&quot;, 2.5M));</span><br><span class="line">            list.Add(new ProductList(5, &quot;橙子&quot;, 3.5M));</span><br><span class="line">            list.Add(new ProductList(6, &quot;橘子&quot;, 5.5M));</span><br><span class="line">            list.Add(new ProductList(7, &quot;鸡肉&quot;, 7.5M));</span><br><span class="line">            list.Add(new ProductList(8, &quot;羊肉&quot;, 7M));</span><br><span class="line">            list.Add(new ProductList(9, &quot;猪肉&quot;, 10M));</span><br><span class="line">            list.Add(new ProductList(10, &quot;牛肉&quot;, 20M));</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;把数据到DataList里面，再绑定数据展示</span><br><span class="line">            this.daList.DataSource &#x3D; list;</span><br><span class="line">            this.daList.DataBind();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-4-Repeater-控件"><a href="#7-4-Repeater-控件" class="headerlink" title="7.4 Repeater 控件"></a>7.4 Repeater 控件</h3><p>Repeater 控件完全由模板驱动，可以任意设置其输出格式。Repeater 控件不生成任何类似于 </p>
<p>标签的布局代码，它为显示数据库记录提供了最大限度的灵活性。在使用 Repeater 控件时，只能在“源”视图中进行编辑。</p>
<p>使用示例：</p>
<p>前端页面Datalist.aspx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;asp:Repeater ID&#x3D;&quot;cateList&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">    &lt;%-- 在使用html标签嵌套时，必须加ItemTemplate标签嵌套 --%&gt;</span><br><span class="line">    &lt;ItemTemplate&gt;</span><br><span class="line">        &lt;dl&gt;</span><br><span class="line">            &lt;dt&gt;&lt;%# Eval(&quot;cateName&quot;) %&gt;&lt;&#x2F;dt&gt;</span><br><span class="line">        &lt;&#x2F;dl&gt;</span><br><span class="line">    &lt;&#x2F;ItemTemplate&gt;</span><br><span class="line">&lt;&#x2F;asp:Repeater&gt;</span><br></pre></td></tr></table></figure>

<p>分类类：Category.cs</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line"></span><br><span class="line">namespace web3</span><br><span class="line">&#123;</span><br><span class="line">    public class Category</span><br><span class="line">    &#123;</span><br><span class="line">        private int cateId;</span><br><span class="line">        private string cateName;</span><br><span class="line"></span><br><span class="line">        public int CateId &#123; get &#x3D;&gt; cateId; set &#x3D;&gt; cateId &#x3D; value; &#125;</span><br><span class="line">        public string CateName &#123; get &#x3D;&gt; cateName; set &#x3D;&gt; cateName &#x3D; value; &#125;</span><br><span class="line"></span><br><span class="line">        public Category(int cateId,string cateName)</span><br><span class="line">        &#123;</span><br><span class="line">            this.cateId &#x3D; cateId;</span><br><span class="line">            this.cateName &#x3D; cateName;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对应的后台逻辑：Datalist.aspx.cs</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.Web.UI;</span><br><span class="line">using System.Web.UI.WebControls;</span><br><span class="line"></span><br><span class="line">namespace web3</span><br><span class="line">&#123;</span><br><span class="line">    public partial class Datalist : System.Web.UI.Page</span><br><span class="line">    &#123;</span><br><span class="line">        protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            if(!IsPostBack)</span><br><span class="line">            &#123;</span><br><span class="line">                getDataList();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void getDataList()</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;获取商品分类回来</span><br><span class="line">            List&lt;Category&gt; cateList &#x3D; new List&lt;Category&gt;();</span><br><span class="line">            cateList.Add(new Category(1,&quot;蔬菜&quot;));</span><br><span class="line">            cateList.Add(new Category(2, &quot;饮料&quot;));</span><br><span class="line">            cateList.Add(new Category(3, &quot;果汁&quot;));</span><br><span class="line">            cateList.Add(new Category(4, &quot;酒类&quot;));</span><br><span class="line">            cateList.Add(new Category(5, &quot;水果&quot;));</span><br><span class="line">            cateList.Add(new Category(6, &quot;家居用品&quot;));</span><br><span class="line">            </span><br><span class="line">            &#x2F;&#x2F;绑定数据显示</span><br><span class="line">            this.cateList.DataSource &#x3D; cateList;</span><br><span class="line">            this.cateList.DataBind();</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第8章-数据绑定控件（二）"><a href="#第8章-数据绑定控件（二）" class="headerlink" title="第8章 数据绑定控件（二）"></a>第8章 数据绑定控件（二）</h2><h3 id="8-1-GridView-数据绑定"><a href="#8-1-GridView-数据绑定" class="headerlink" title="8.1 GridView 数据绑定"></a>8.1 GridView 数据绑定</h3><p>GridView 控件以表格的形式显示数据源的数据，每列表示一个字段，而每行表示一条记录。其最大的特点是自动化程度高，可以在不编写代码的情况下实现分页和排序等功能。常用属性如下：</p>
<table>
<thead>
<tr>
<th><strong>属性名</strong></th>
<th><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td>AllowPaging</td>
<td>设置是否启用分页功能</td>
</tr>
<tr>
<td>Columns</td>
<td>获取 GridView 控件中列字段的集合</td>
</tr>
<tr>
<td>PageCount</td>
<td>获取在 GridView 控件中显示数据源记录所需的页数</td>
</tr>
<tr>
<td>PageIndex</td>
<td>获取或设置当前显示页的索引</td>
</tr>
<tr>
<td>PageSize</td>
<td>设置 GridView 控件每次显示的最大记录条数</td>
</tr>
</tbody></table>
<p>使用示例，先是DAL层的编写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">using Models;</span><br><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Data.SqlClient;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;数据访问层：访问数据模型层</span><br><span class="line">namespace DAL1</span><br><span class="line">&#123;</span><br><span class="line">    public class UserInfoService</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F;获取用户列表返回</span><br><span class="line">        public static List&lt;UserInfo&gt; getUserInfoList()</span><br><span class="line">        &#123;</span><br><span class="line">            string sql &#x3D; string.Format(&quot;select * from userInfo&quot;);</span><br><span class="line">            SqlDataReader dr &#x3D; DBHelper.GetReader(sql);</span><br><span class="line">            UserInfo user &#x3D; null;</span><br><span class="line">            &#x2F;&#x2F;只要可读，就组装添加这个用户信息到列表返回</span><br><span class="line">            List&lt;UserInfo&gt; lists &#x3D; new List&lt;UserInfo&gt;();</span><br><span class="line">            while (dr.Read())</span><br><span class="line">            &#123;</span><br><span class="line">                user &#x3D; new UserInfo();</span><br><span class="line">                user.userID &#x3D; dr.GetInt32(0); &#x2F;&#x2F;0为取出来时的数组下标</span><br><span class="line">                user.userName &#x3D; dr.GetString(1);</span><br><span class="line">                user.QQ &#x3D; dr.GetString(2);</span><br><span class="line">                user.password &#x3D; dr.GetString(3);</span><br><span class="line">                user.phone &#x3D; dr.GetString(4);</span><br><span class="line">                user.address &#x3D; dr.GetString(5);</span><br><span class="line">                user.createTime &#x3D; dr.GetDateTime(6);</span><br><span class="line">                </span><br><span class="line">                &#x2F;&#x2F;添加到泛型集合中返回</span><br><span class="line">                lists.Add(user);</span><br><span class="line">            &#125;</span><br><span class="line">            &#x2F;&#x2F;关闭读</span><br><span class="line">            dr.Close();</span><br><span class="line">            return lists;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BLL层编写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">using DAL1;</span><br><span class="line">using Models;</span><br><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;业务层</span><br><span class="line">namespace BLL</span><br><span class="line">&#123;</span><br><span class="line">    public class UserInfoManager</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F;获取用户列表返回</span><br><span class="line">        public static List&lt;UserInfo&gt; getUserList()</span><br><span class="line">        &#123;</span><br><span class="line">            return UserInfoService.getUserInfoList();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>页面展示层gridView.aspx编写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;gridView.aspx.cs&quot; Inherits&#x3D;&quot;web3.gridView&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot;&gt;</span><br><span class="line">&lt;head runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&#x2F;&gt;</span><br><span class="line">    &lt;title&gt;&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">        &lt;asp:GridView ID&#x3D;&quot;gv&quot; runat&#x3D;&quot;server&quot; AutoGenerateColumns&#x3D;&quot;False&quot;&gt;</span><br><span class="line">            &lt;Columns&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;userId&quot; HeaderText&#x3D;&quot;用户ID&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;userName&quot; HeaderText&#x3D;&quot;用户名&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;qq&quot; HeaderText&#x3D;&quot;QQ&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;password&quot; HeaderText&#x3D;&quot;密码&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;phone&quot; HeaderText&#x3D;&quot;手机号&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;address&quot; HeaderText&#x3D;&quot;地址&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;createtime&quot; DataFormatString&#x3D;&quot;&#123;0:d&#125;&quot; HeaderText&#x3D;&quot;创建时间&quot; &#x2F;&gt;</span><br><span class="line">            &lt;&#x2F;Columns&gt;</span><br><span class="line">        &lt;&#x2F;asp:GridView&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>对应页面代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">using BLL;</span><br><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.Web.UI;</span><br><span class="line">using System.Web.UI.WebControls;</span><br><span class="line"></span><br><span class="line">namespace web3</span><br><span class="line">&#123;</span><br><span class="line">    public partial class gridView : System.Web.UI.Page</span><br><span class="line">    &#123;</span><br><span class="line">        protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            if(!IsPostBack)</span><br><span class="line">            &#123;</span><br><span class="line">                getList();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void getList()</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;先引入BLL逻辑层，再使用列表</span><br><span class="line">            this.gv.DataSource &#x3D; UserInfoManager.getUserList();</span><br><span class="line">            this.gv.DataBind();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-2-GridView-数据删除"><a href="#8-2-GridView-数据删除" class="headerlink" title="8.2 GridView 数据删除"></a>8.2 GridView 数据删除</h3><p>GridView 不仅可以用于数据的显示，还具有对数据进行删除和修改的功能。 前端页面新增删除按钮，gridView.aspx页面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;C#&quot; AutoEventWireup&#x3D;&quot;true&quot; CodeBehind&#x3D;&quot;gridView.aspx.cs&quot; Inherits&#x3D;&quot;web3.gridView&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot;&gt;</span><br><span class="line">&lt;head runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&#x2F;&gt;</span><br><span class="line">    &lt;title&gt;&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form id&#x3D;&quot;form1&quot; runat&#x3D;&quot;server&quot;&gt;</span><br><span class="line">        &lt;asp:GridView ID&#x3D;&quot;gv&quot; runat&#x3D;&quot;server&quot; AutoGenerateColumns&#x3D;&quot;False&quot; OnRowDeleting&#x3D;&quot;gv_RowDeleting&quot; OnSelectedIndexChanged&#x3D;&quot;gv_SelectedIndexChanged&quot;&gt;</span><br><span class="line">            &lt;Columns&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;userId&quot; HeaderText&#x3D;&quot;用户ID&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;userName&quot; HeaderText&#x3D;&quot;用户名&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;qq&quot; HeaderText&#x3D;&quot;QQ&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;password&quot; HeaderText&#x3D;&quot;密码&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;phone&quot; HeaderText&#x3D;&quot;手机号&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;address&quot; HeaderText&#x3D;&quot;地址&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:BoundField DataField&#x3D;&quot;createtime&quot; DataFormatString&#x3D;&quot;&#123;0:d&#125;&quot; HeaderText&#x3D;&quot;创建时间&quot; &#x2F;&gt;</span><br><span class="line">                &lt;asp:CommandField ShowDeleteButton&#x3D;&quot;True&quot; &#x2F;&gt;</span><br><span class="line">            &lt;&#x2F;Columns&gt;</span><br><span class="line">        &lt;&#x2F;asp:GridView&gt;</span><br><span class="line">    &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>对应的gridView.aspx.cs页面后台代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">using BLL;</span><br><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.Web.UI;</span><br><span class="line">using System.Web.UI.WebControls;</span><br><span class="line"></span><br><span class="line">namespace web3</span><br><span class="line">&#123;</span><br><span class="line">    public partial class gridView : System.Web.UI.Page</span><br><span class="line">    &#123;</span><br><span class="line">        protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            if(!IsPostBack)</span><br><span class="line">            &#123;</span><br><span class="line">                getList();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void getList()</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;先引入BLL逻辑层，再使用列表</span><br><span class="line">            this.gv.DataSource &#x3D; UserInfoManager.getUserList();</span><br><span class="line">            this.gv.DataBind();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        protected void gv_SelectedIndexChanged(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;行删除事件</span><br><span class="line">        protected void gv_RowDeleting(object sender, GridViewDeleteEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;获取当前行的编号ID</span><br><span class="line">            int userId &#x3D; int.Parse(this.gv.Rows[e.RowIndex].Cells[0].Text);</span><br><span class="line">            &#x2F;&#x2F;通过ID删除这个数据</span><br><span class="line">            if(UserInfoManager.DeleteUser(userId))</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F;删除成功刷新列表</span><br><span class="line">                getList();</span><br><span class="line">                &#x2F;&#x2F;弹出脚本</span><br><span class="line">                Response.Write(&quot;&lt;script&gt;alert(&#39;删除成功！&#39;);&lt;&#x2F;script&gt;&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F;删除失败提示</span><br><span class="line">                Response.Write(&quot;&lt;script&gt;alert(&#39;删除失败！&#39;);&lt;&#x2F;script&gt;&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>删除逻辑BLL：UserInfoManager.cs页面：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;删除用户</span><br><span class="line">public static bool DeleteUser(int userId)</span><br><span class="line">&#123;</span><br><span class="line">    return UserInfoService.deleteUserById(userId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-3-GridView-数据修改"><a href="#8-3-GridView-数据修改" class="headerlink" title="8.3 GridView 数据修改"></a>8.3 GridView 数据修改</h3><p>GridView 以表格形式展示数据，可以在表格最后增加一列“编辑”，当点击编辑按钮时，可以对该行数据进行修改： 1、点击 GridView 控件右侧的箭头，显示 GridView 任务菜单，选择“编辑列“</p>
<p>2、选中 CommandField 列中的“编辑、更新、取消”列，点击“添加”按钮</p>
<p>3、为 GridView 控件添加 RowEditing、RowUpdating 以及 RowCancelingEdit 事件 RowEditing：开始编辑事件 RowUpdating：开始更新事件 RowCancelingEdit：取消编辑事件</p>
<p>4、编写 RowEditing 事件，当用户点击编辑时打开编辑状态，让用户可以在当前行输入数据</p>
<p>使用示例：gridView.aspx.cs文件的实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">using BLL;</span><br><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Web;</span><br><span class="line">using System.Web.UI;</span><br><span class="line">using System.Web.UI.WebControls;</span><br><span class="line"></span><br><span class="line">namespace web3</span><br><span class="line">&#123;</span><br><span class="line">    public partial class gridView : System.Web.UI.Page</span><br><span class="line">    &#123;</span><br><span class="line">        protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            if(!IsPostBack)</span><br><span class="line">            &#123;</span><br><span class="line">                getList();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void getList()</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;先引入BLL逻辑层，再使用列表</span><br><span class="line">            this.gv.DataSource &#x3D; UserInfoManager.getUserList();</span><br><span class="line">            this.gv.DataBind();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        protected void gv_SelectedIndexChanged(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;行删除事件</span><br><span class="line">        protected void gv_RowDeleting(object sender, GridViewDeleteEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;获取当前行的编号ID</span><br><span class="line">            int userId &#x3D; int.Parse(this.gv.Rows[e.RowIndex].Cells[0].Text);</span><br><span class="line">            &#x2F;&#x2F;通过ID删除这个数据</span><br><span class="line">            if(UserInfoManager.DeleteUser(userId))</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F;删除成功刷新列表</span><br><span class="line">                getList();</span><br><span class="line">                &#x2F;&#x2F;弹出脚本</span><br><span class="line">                Response.Write(&quot;&lt;script&gt;alert(&#39;删除成功！&#39;);&lt;&#x2F;script&gt;&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F;删除失败提示</span><br><span class="line">                Response.Write(&quot;&lt;script&gt;alert(&#39;删除失败！&#39;);&lt;&#x2F;script&gt;&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;编辑对应行的操作</span><br><span class="line">        protected void gv_RowEditing(object sender, GridViewEditEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;设置开启绑定，获取当前编辑的索引给到它，让它执行行编辑</span><br><span class="line">            this.gv.EditIndex &#x3D;  e.NewEditIndex;</span><br><span class="line">            getList();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;取消编辑</span><br><span class="line">        protected void gv_RowCancelingEdit(object sender, GridViewCancelEditEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;设置当编辑行索引为-1即可</span><br><span class="line">            this.gv.EditIndex &#x3D; -1;</span><br><span class="line">            getList();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F;执行编辑操作</span><br><span class="line">        protected void gv_RowUpdating(object sender, GridViewUpdateEventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            &#x2F;&#x2F;获取编辑行的索引</span><br><span class="line">            int userId &#x3D; int.Parse(this.gv.Rows[e.RowIndex].Cells[0].Text);</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;组装user用户进行编辑</span><br><span class="line">            Models.UserInfo user &#x3D; new Models.UserInfo();</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;组装用户信息用于编辑</span><br><span class="line">            user.userID &#x3D; userId;</span><br><span class="line">            &#x2F;&#x2F;因为点击编辑时，生成的值修改是放在input框中，需要获取到的是输入框中的值，并且转换成Text文本才能获取</span><br><span class="line">            user.userName &#x3D; ((TextBox)this.gv.Rows[e.RowIndex].Cells[1].Controls[0]).Text;</span><br><span class="line">            user.QQ &#x3D; ((TextBox)this.gv.Rows[e.RowIndex].Cells[2].Controls[0]).Text;</span><br><span class="line">            user.password &#x3D; ((TextBox)this.gv.Rows[e.RowIndex].Cells[3].Controls[0]).Text;</span><br><span class="line">            user.phone &#x3D; ((TextBox)this.gv.Rows[e.RowIndex].Cells[4].Controls[0]).Text;</span><br><span class="line">            user.address &#x3D; ((TextBox)this.gv.Rows[e.RowIndex].Cells[5].Controls[0]).Text;</span><br><span class="line">            &#x2F;&#x2F;需要把文本类型转换成日期时间格式</span><br><span class="line">            user.createTime &#x3D; DateTime.Parse(((TextBox)this.gv.Rows[e.RowIndex].Cells[6].Controls[0]).Text);</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F;执行修改操作</span><br><span class="line">            if (UserInfoManager.UpdateUser(user))</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F;退出编辑模式</span><br><span class="line">                this.gv.EditIndex &#x3D; -1;</span><br><span class="line">                &#x2F;&#x2F;刷新列表</span><br><span class="line">                getList();</span><br><span class="line">                &#x2F;&#x2F;提示成功</span><br><span class="line">                ClientScript.RegisterStartupScript(this.GetType(), &quot;updateSuccess&quot;, &quot;&lt;script&gt;alert(&#39;修改成功!&#39;);&lt;&#x2F;script&gt;&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                &#x2F;&#x2F;退出编辑模式</span><br><span class="line">                this.gv.EditIndex &#x3D; -1;</span><br><span class="line">                ClientScript.RegisterStartupScript(this.GetType(), &quot;updateError&quot;, &quot;&lt;script&gt;alert(&#39;修改失败!&#39;);&lt;&#x2F;script&gt;&quot;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-4-GridView-数据分页"><a href="#8-4-GridView-数据分页" class="headerlink" title="8.4 GridView 数据分页"></a>8.4 GridView 数据分页</h3><p>为什么需要对列表数据进行分页？</p>
<p>1、减轻服务端压力，节约内存开销 2、提高运行效率和速度 3、客户端速度快，更美观，用户体验高</p>
<p>GridView 控件以表格的形式显示数据源的数据，当数据较多时，无法在一个页面显示所有数据，这个时候就需要对数据进行分页操作。 GridView 本身自带有分页的功能操作，需要设置一些属性和事件来完成分页：</p>
<table>
<thead>
<tr>
<th><strong>属性名**</strong>/事件名**</th>
<th><strong>作用</strong></th>
</tr>
</thead>
<tbody><tr>
<td>AllowPaging属性</td>
<td>设置是否启用分页功能</td>
</tr>
<tr>
<td>PageCount 属性</td>
<td>获取在 GridView 控件中显示数据源记录所需的页数</td>
</tr>
<tr>
<td>PageIndex 属性</td>
<td>获取或设置当前显示页的索引</td>
</tr>
<tr>
<td>PageSize属性</td>
<td>设置 GridView 控件每次显示的最大记录条数</td>
</tr>
<tr>
<td>PageIndexChanging 事件</td>
<td>页码索引改变触发事件</td>
</tr>
</tbody></table>
<p>为 UserInfoList.aspx 页面的 GridView 控件增加分页功能。步骤如下： 1、选中 GridView 控件，点击右键选择属性，设置 AllowPaging 为 True，开启分页功能 2、设置 PageSize属性 为 5，每页显示 5 条记录</p>
<p>为 UserInfoList.aspx 页面的 GridView 控件增加分页功能。步骤如下： 3、选中 GridView 控件，点击右键选择属性，找到 GridView 事件中的PageIndexChanging 事件，双击产生此事件，在事件中设置用户每次操作的新页码</p>
<p>实现示例：gridView.aspx.cs文件编写代码：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//分页索引改变，触发这个方法</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">gv_PageIndexChanging</span>(<span class="params"><span class="built_in">object</span> sender, GridViewPageEventArgs e</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//把新的分页的索引替换当前的页索引，即可实现分页</span></span><br><span class="line">    <span class="keyword">this</span>.gv.PageIndex = e.NewPageIndex;</span><br><span class="line">    getList();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>SpreadWings-Sky</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://spreadwings-sky.github.io/2020/12/28/ASP.NET%20web%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/" title="ASP.NET web">https://spreadwings-sky.github.io/2020/12/28/ASP.NET%20web%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/03/20/hello-world/" rel="prev" title="Hello World"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">Hello World</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2020/08/18/%E5%8D%9A%E5%AE%A2%E6%8A%A5%E9%94%99%E4%BF%AE%E5%A4%8D/" rel="next" title="博客报错修复"><span class="post-nav-text">博客报错修复</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> SpreadWings-Sky</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v5.4.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.5.1</span></div><div class="live_time"><span>本博客已低调运行</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2020-04-15T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " 天 " + passHour + " 小时 " + passMinute + " 分 " + passSecond + " 秒";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><script>const date = new Date();
const today = (date.getMonth() + 1) + "-" + date.getDate()
const mourn_days = ["4-4"]
if (mourn_days.includes(today)) {
  document.documentElement.style.filter = "grayscale(1)";
}</script><div class="aplayer no-destroy" id="aplayer" data-id="2383293092" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay data-theme="#0078E7" data-loop="all" data-order="list" data-preload="auto" data-volume="0.7" data-mutex data-lrctype="0" data-listfolded data-listmaxheight="340px" data-storagename="metingjs"></div></div></body></html>